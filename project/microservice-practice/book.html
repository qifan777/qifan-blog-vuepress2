<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.67" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://mister-hope.github.io/blog/project/microservice-practice/book.html"><meta property="og:site_name" content="èµ·å‡¡Codeé—²èŠ"><meta property="og:title" content="å¤šæ¨¡å—å¾®æœåŠ¡æ„å»ºéƒ¨ç½²å®æˆ˜"><meta property="og:description" content="å¤šæ¨¡å—å¾®æœåŠ¡æ„å»ºéƒ¨ç½²å®æˆ˜ ä»‹ç» æœ¬é¡¹ç›®çš„æ•™å­¦ç›®çš„æ˜¯é€šè¿‡ä¸€ä¸ªå¤šæ¨¡å—çš„é¡¹ç›®ï¼Œæ¥è®²è§£å¦‚ä½•æ­å»ºå¤šæ¨¡å—ï¼Œå¼€å‘ï¼Œéƒ¨ç½²ã€‚åˆæ¬¡ä¹‹å¤–ä½ è¿˜å¯ä»¥å­¦åˆ°å…¶ä»–é‡è¦çš„åç«¯çŸ¥è¯†ã€‚ æç¤º çŸ¥è¯†æ¦‚è§ˆ Mavenå¤šæ¨¡å—æ„å»º SpringBootæ‰“åŒ…æˆå¯æ‰§è¡ŒjaråŒ… Docker Composeéƒ¨ç½²åˆ°Docker å¾®æœåŠ¡å…­è¾¹å½¢æ¶æ„ï¼ˆé¢†åŸŸé©±åŠ¨DDDï¼‰ JPA+QueryDsl å¢åˆ æ”¹æŸ¥ï¼ŒåŠ¨æ€sqlï¼Œå¤šè¡¨join Java Bean Validation æ•°æ®æ ¡éªŒ MapStructä¸šåŠ¡åˆ†å±‚é—´dtoè½¬åŒ–"><meta property="og:type" content="article"><meta property="og:image" content="https://mister-hope.github.io/blog/"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2023-09-30T12:47:34.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="å¤šæ¨¡å—å¾®æœåŠ¡æ„å»ºéƒ¨ç½²å®æˆ˜"><meta property="article:author" content="èµ·å‡¡"><meta property="article:tag" content="é¢†åŸŸé©±åŠ¨DDD"><meta property="article:tag" content="å…­è¾¹å½¢æ¶æ„"><meta property="article:tag" content="éƒ¨ç½²"><meta property="article:tag" content="Docker"><meta property="article:tag" content="Maven"><meta property="article:published_time" content="2022-11-05T00:00:00.000Z"><meta property="article:modified_time" content="2023-09-30T12:47:34.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"å¤šæ¨¡å—å¾®æœåŠ¡æ„å»ºéƒ¨ç½²å®æˆ˜","image":["https://mister-hope.github.io/blog/"],"datePublished":"2022-11-05T00:00:00.000Z","dateModified":"2023-09-30T12:47:34.000Z","author":[{"@type":"Person","name":"èµ·å‡¡","url":"https://www.jarcheng.top"}]}</script><title>å¤šæ¨¡å—å¾®æœåŠ¡æ„å»ºéƒ¨ç½²å®æˆ˜ | èµ·å‡¡Codeé—²èŠ</title><meta name="description" content="å¤šæ¨¡å—å¾®æœåŠ¡æ„å»ºéƒ¨ç½²å®æˆ˜ ä»‹ç» æœ¬é¡¹ç›®çš„æ•™å­¦ç›®çš„æ˜¯é€šè¿‡ä¸€ä¸ªå¤šæ¨¡å—çš„é¡¹ç›®ï¼Œæ¥è®²è§£å¦‚ä½•æ­å»ºå¤šæ¨¡å—ï¼Œå¼€å‘ï¼Œéƒ¨ç½²ã€‚åˆæ¬¡ä¹‹å¤–ä½ è¿˜å¯ä»¥å­¦åˆ°å…¶ä»–é‡è¦çš„åç«¯çŸ¥è¯†ã€‚ æç¤º çŸ¥è¯†æ¦‚è§ˆ Mavenå¤šæ¨¡å—æ„å»º SpringBootæ‰“åŒ…æˆå¯æ‰§è¡ŒjaråŒ… Docker Composeéƒ¨ç½²åˆ°Docker å¾®æœåŠ¡å…­è¾¹å½¢æ¶æ„ï¼ˆé¢†åŸŸé©±åŠ¨DDDï¼‰ JPA+QueryDsl å¢åˆ æ”¹æŸ¥ï¼ŒåŠ¨æ€sqlï¼Œå¤šè¡¨join Java Bean Validation æ•°æ®æ ¡éªŒ MapStructä¸šåŠ¡åˆ†å±‚é—´dtoè½¬åŒ–">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/blog/assets/style-8e162f28.css" as="style"><link rel="stylesheet" href="/blog/assets/style-8e162f28.css">
    <link rel="modulepreload" href="/blog/assets/app-fca60335.js"><link rel="modulepreload" href="/blog/assets/book.html-4464f2cb.js"><link rel="modulepreload" href="/blog/assets/book.html-ca2525b8.js"><link rel="modulepreload" href="/blog/assets/plugin-vue_export-helper-c27b6911.js"><link rel="prefetch" href="/blog/assets/index.html-e38997c9.js" as="script"><link rel="prefetch" href="/blog/assets/intro.html-8334be15.js" as="script"><link rel="prefetch" href="/blog/assets/slides.html-0451b31e.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d2ed6b96.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-6587908d.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2a6fb65f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-074718db.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-22f5890b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ecf14fe9.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-71aa29f2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ba7a5f3f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5b24ced8.js" as="script"><link rel="prefetch" href="/blog/assets/shell.html-bce828ea.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b788e860.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c51c6d19.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e4216ee9.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2b6728b9.js" as="script"><link rel="prefetch" href="/blog/assets/criteria.html-b48bf459.js" as="script"><link rel="prefetch" href="/blog/assets/fetch.html-cf972132.js" as="script"><link rel="prefetch" href="/blog/assets/READEME.html-f0d6f0f3.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-268d721f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e2875aef.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-8c29b5a9.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-00807b26.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-309ea541.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-cd9389f2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-70bf3015.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d4c6839c.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-6ae69e05.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-faabd0c5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-66c436a8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c63c8cd8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-89b8d010.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f56f89cd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-61fa7a26.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-70d16a26.js" as="script"><link rel="prefetch" href="/blog/assets/mp-wechat-auth.html-678137ed.js" as="script"><link rel="prefetch" href="/blog/assets/mp-wechat-register.html-01208167.js" as="script"><link rel="prefetch" href="/blog/assets/phone-password-auth.html-a33b75ca.js" as="script"><link rel="prefetch" href="/blog/assets/phone-password-register.html-62d3a6df.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-7ab76c57.js" as="script"><link rel="prefetch" href="/blog/assets/crud.html-4927d46c.js" as="script"><link rel="prefetch" href="/blog/assets/menu.html-95f49ac5.js" as="script"><link rel="prefetch" href="/blog/assets/role.html-cd8387e5.js" as="script"><link rel="prefetch" href="/blog/assets/user.html-b3ede5e5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2523db80.js" as="script"><link rel="prefetch" href="/blog/assets/deploy.html-d6ef2fcb.js" as="script"><link rel="prefetch" href="/blog/assets/develop.html-973b4b35.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ced8c462.js" as="script"><link rel="prefetch" href="/blog/assets/cart.html-3b34239c.js" as="script"><link rel="prefetch" href="/blog/assets/category.html-5726d565.js" as="script"><link rel="prefetch" href="/blog/assets/product.html-20d61910.js" as="script"><link rel="prefetch" href="/blog/assets/sku.html-e4463d87.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3bc89d25.js" as="script"><link rel="prefetch" href="/blog/assets/front.html-272a4cdd.js" as="script"><link rel="prefetch" href="/blog/assets/generator.html-2d112172.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-279aaf96.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-8ebb5575.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-56f2f82e.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-a43da947.js" as="script"><link rel="prefetch" href="/blog/assets/404.html-c90690cd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-145aa18d.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c6192253.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e4e33b97.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ded9a48a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-84a6ac68.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-7c0da80b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d55345e6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-20002d99.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d3f31ffe.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5e8e663c.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0c096166.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-1a648e52.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f23ec895.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-67eac555.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-052ffb67.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-48961ef6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b984ce1d.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9479c172.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b632a18f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d94755a1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-22d8eee4.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c55e260e.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9991b30d.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-068553ae.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-95b3cc14.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e590dfe0.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-983b520a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c6728120.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-a5be7e20.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-215c037c.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-66d4ea0b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-22f5cde9.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-996fd8ce.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-6c09ec06.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-4cae1e6e.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-54a714f7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-80b4aa0e.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-44a3bf2d.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f643b85f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3933bd6f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-36c1dc76.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-46dca514.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9deda3d2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f943d4f6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2ff54d22.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5b76df8a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f34a123a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-bee6107b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-015e1873.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-673b328b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f28f595a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b8250845.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-69c952b3.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b93dd634.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d06c722b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b0fa9d63.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3eb51e60.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b24ac7b4.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-45e055e3.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ff402b21.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ee3d46ad.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-01c1bb30.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e795a79b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-6fda2f83.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-180864a6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-10587953.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-acf20e03.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-7cfced2b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c892ce4d.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-07d34f3a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3b545bd2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-a666392e.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-144eb011.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-bdc50d5b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-cb9b0991.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-85458afd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-aa72717c.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3ad07117.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3bc8559a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-6af4661e.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-48c1c815.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9120348f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3b47096c.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0a275165.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-57cd599c.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0bf79520.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e562e190.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2954b6c2.js" as="script"><link rel="prefetch" href="/blog/assets/intro.html-bced9be9.js" as="script"><link rel="prefetch" href="/blog/assets/slides.html-364e9568.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e1b20d9c.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-bcf48be8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-4d79c83d.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e1abbe65.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0d4f805e.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-6c681cf5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3f993d63.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-998e16a7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-a6549485.js" as="script"><link rel="prefetch" href="/blog/assets/shell.html-aa2f81bd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f59635e1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9e6ac385.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d151e299.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-87bd3a03.js" as="script"><link rel="prefetch" href="/blog/assets/criteria.html-80e8c9b0.js" as="script"><link rel="prefetch" href="/blog/assets/fetch.html-9f272b1d.js" as="script"><link rel="prefetch" href="/blog/assets/READEME.html-42185b5b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5ca6e029.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e31395c2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-14c3b421.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-a8a76f06.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ed102384.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-85f8485c.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-42729a12.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3f2eee64.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b7f4100d.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-4581f040.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-4387d748.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c10bab81.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-fef407cf.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b70a76b4.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0b910fc5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2d6ef3d5.js" as="script"><link rel="prefetch" href="/blog/assets/mp-wechat-auth.html-8f5f0b20.js" as="script"><link rel="prefetch" href="/blog/assets/mp-wechat-register.html-f8c4db28.js" as="script"><link rel="prefetch" href="/blog/assets/phone-password-auth.html-5e824768.js" as="script"><link rel="prefetch" href="/blog/assets/phone-password-register.html-89167a63.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c63f6285.js" as="script"><link rel="prefetch" href="/blog/assets/crud.html-8d895f4d.js" as="script"><link rel="prefetch" href="/blog/assets/menu.html-b29651f5.js" as="script"><link rel="prefetch" href="/blog/assets/role.html-345ca97f.js" as="script"><link rel="prefetch" href="/blog/assets/user.html-00c242db.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d50636a7.js" as="script"><link rel="prefetch" href="/blog/assets/deploy.html-76da040d.js" as="script"><link rel="prefetch" href="/blog/assets/develop.html-c5c875ab.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ed22aec5.js" as="script"><link rel="prefetch" href="/blog/assets/cart.html-ce78b41c.js" as="script"><link rel="prefetch" href="/blog/assets/category.html-7608ec19.js" as="script"><link rel="prefetch" href="/blog/assets/product.html-ac50055d.js" as="script"><link rel="prefetch" href="/blog/assets/sku.html-22fcf537.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-de6e9664.js" as="script"><link rel="prefetch" href="/blog/assets/front.html-4d55c6c4.js" as="script"><link rel="prefetch" href="/blog/assets/generator.html-9fa73200.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f5d69a09.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-31a187dd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-269a0755.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-99674892.js" as="script"><link rel="prefetch" href="/blog/assets/404.html-1a83ffaf.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-a1c22ac0.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f0b33adc.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0da2d036.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2097bf41.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0deb9d33.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-8106feda.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-4efc6506.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ac2373f5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-230bc7d4.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ec87378f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-4b6185bf.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-6fe3fa96.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9d632626.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-18738ffc.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-309733a7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-292d55d0.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d13fbaa5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-48f84dac.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-edc1b90f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f9181667.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d0a3b2c8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c3879c5d.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2e99a610.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-99294b73.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-926c0984.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5890147f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-674c1eef.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c011373f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ce388c66.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-defa7302.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c7ff79c5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-9566cac8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c198b570.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-0ef7ccd4.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ba1b1fbd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-1eb0a46e.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-89ef8da4.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2d103f9c.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-53314ef7.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-aa8817a3.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-a888df6d.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-1ca39163.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-a3712294.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-3387f78f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b45c24a1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b67ee642.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-553558a8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-ef5287b2.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2e09d98e.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b903d161.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f2c6907b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-f47e7d32.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-1c18c5b8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5976bb76.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-509d5801.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-8a179c66.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-58cd6e6a.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-63f5d4bd.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-181d1a34.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5345a4cc.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-56e6c4b0.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-b82a9f50.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5079ffe1.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-50e7867f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-764852d4.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-d17b208d.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-a073573b.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2ccd2938.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-74e382db.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-a889b678.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-e53e0fc6.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-453b8b78.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-94843fc9.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-2a876cb5.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-1c8e5960.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-57b047c8.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-427d0c25.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-57d333ca.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-5a62f138.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-57e188ce.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-7d924a16.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-86df8a84.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-14d7eb2d.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c598da2f.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-49bc62c0.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-83ccb3fc.js" as="script"><link rel="prefetch" href="/blog/assets/index.html-c6b233ad.js" as="script"><link rel="prefetch" href="/blog/assets/giscus-0b7adcf8.js" as="script"><link rel="prefetch" href="/blog/assets/auto-fe80bb03.js" as="script"><link rel="prefetch" href="/blog/assets/index-2bf332f6.js" as="script"><link rel="prefetch" href="/blog/assets/mermaid.core-a8459cae.js" as="script"><link rel="prefetch" href="/blog/assets/highlight.esm-75b11b9d.js" as="script"><link rel="prefetch" href="/blog/assets/markdown.esm-9d5bc2ce.js" as="script"><link rel="prefetch" href="/blog/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/blog/assets/notes.esm-a106bb2c.js" as="script"><link rel="prefetch" href="/blog/assets/reveal.esm-1a4c3ae7.js" as="script"><link rel="prefetch" href="/blog/assets/search.esm-7e6792e2.js" as="script"><link rel="prefetch" href="/blog/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/blog/assets/VuePlayground-1e432975.js" as="script"><link rel="prefetch" href="/blog/assets/photoswipe.esm-1a9f4b8e.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">è·³è‡³ä¸»è¦å…§å®¹</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header id="navbar" class="vp-navbar"><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><!--[--><a class="vp-link vp-brand vp-brand" href="/blog/"><img class="vp-nav-logo" src="/blog/logo.jpg" alt="èµ·å‡¡Codeé—²èŠ"><!----><span class="vp-site-name hide-in-pad">èµ·å‡¡Codeé—²èŠ</span></a><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-center"><!--[--><!----><!--]--><!--[--><nav class="vp-nav-links"><div class="nav-item hide-in-mobile"><a aria-label="åšå®¢ä¸»é¡µ" class="vp-link nav-link nav-link" href="/blog/"><span class="font-icon icon fa-fw fa-sm fas fa-home" style=""></span>åšå®¢ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="é¡¹ç›®å®æˆ˜"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-pen-to-square" style=""></span>é¡¹ç›®å®æˆ˜</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-label="é£é¸½é‚®ç­’" class="vp-link nav-link nav-link" href="/blog/project/post-letter/"><!---->é£é¸½é‚®ç­’<!----></a></li><li class="dropdown-item"><a aria-label="å¤šæ¨¡å—å¾®æœåŠ¡å®æˆ˜" class="vp-link nav-link active nav-link active" href="/blog/project/microservice-practice/book.html"><!---->å¤šæ¨¡å—å¾®æœåŠ¡å®æˆ˜<!----></a></li><li class="dropdown-item"><a aria-label="ChatGPTåŠ©æ‰‹" class="vp-link nav-link nav-link" href="/blog/project/chatgpt-assistant/"><!---->ChatGPTåŠ©æ‰‹<!----></a></li><li class="dropdown-item"><a aria-label="èµ·å‡¡å•†åŸ" class="vp-link nav-link nav-link" href="/blog/project/qifan-mall.html"><!---->èµ·å‡¡å•†åŸ<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="å·¥å…·åˆ†äº«"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-screwdriver-wrench" style=""></span>å·¥å…·åˆ†äº«</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-label="ç§æœ‰ChatGPTæ­å»º" class="vp-link nav-link nav-link" href="/blog/tools/chatgpt/"><!---->ç§æœ‰ChatGPTæ­å»º<!----></a></li><li class="dropdown-item"><a aria-label="è¿œç¨‹å¼€å‘ç¯å¢ƒæ­å»º" class="vp-link nav-link nav-link" href="/blog/tools/remote-develop/"><!---->è¿œç¨‹å¼€å‘ç¯å¢ƒæ­å»º<!----></a></li><li class="dropdown-item"><a aria-label="vue-press2æ­å»ºåšå®¢" class="vp-link nav-link nav-link" href="/blog/tools/vue-press2/"><!---->vue-press2æ­å»ºåšå®¢<!----></a></li><li class="dropdown-item"><a aria-label="CI/CDä¸Jenkins" class="vp-link nav-link nav-link" href="/blog/tools/jenkins/"><!---->CI/CDä¸Jenkins<!----></a></li><li class="dropdown-item"><a aria-label="idea-å¼ºå¤§çš„shellå·¥å…·" class="vp-link nav-link nav-link" href="/blog/tools/idea/shell.html"><!---->idea-å¼ºå¤§çš„shellå·¥å…·<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button type="button" class="dropdown-title" aria-label="çŸ¥è¯†åˆ†äº«"><span class="title"><span class="font-icon icon fa-fw fa-sm fas fa-book" style=""></span>çŸ¥è¯†åˆ†äº«</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>Spring</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a aria-label="AOP" class="vp-link nav-link nav-link" href="/blog/knowledge/spring/aop.html"><!---->AOP<!----></a></li><li class="dropdown-subitem"><a aria-label="å¦‚ä½•å‘é€httpè¯·æ±‚å„ç§å‚æ•°" class="vp-link nav-link nav-link" href="/blog/knowledge/spring/http.html"><!---->å¦‚ä½•å‘é€httpè¯·æ±‚å„ç§å‚æ•°<!----></a></li></ul></li><li class="dropdown-item"><a aria-label="JPA" class="vp-link nav-link nav-link" href="/blog/knowledge/jpa/hibernate/"><!---->JPA<!----></a></li><li class="dropdown-item"><a aria-label="Nginxåšå®¢/ç½‘ç«™æ­å»º" class="vp-link nav-link nav-link" href="/blog/knowledge/website/"><!---->Nginxåšå®¢/ç½‘ç«™æ­å»º<!----></a></li><li class="dropdown-item"><a aria-label="å‰ç«¯å·¥å…·é“¾" class="vp-link nav-link nav-link" href="/blog/knowledge/vite/"><!---->å‰ç«¯å·¥å…·é“¾<!----></a></li></ul></button></div></div></nav><!--]--><!--[--><!----><!--]--></div><div class="vp-navbar-end"><!--[--><!----><!--]--><!--[--><!----><div class="nav-item vp-repo"><a class="vp-repo-link" href="https://github.com/qifan777/qifan-blog-vuepress2" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button type="button" id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--]--><!--[--><!----><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar"><!--[--><!----><!--]--><ul class="vp-sidebar-links"><li><!--[--><a aria-label="ä»‹ç»" class="vp-link nav-link vp-sidebar-link vp-sidebar-heading nav-link vp-sidebar-link vp-sidebar-heading" href="/blog/project/microservice-practice/book.html#ä»‹ç»"><!---->ä»‹ç»<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="1. å¤šæ¨¡å—ä¸å¾®æœåŠ¡" class="vp-link nav-link vp-sidebar-link vp-sidebar-heading nav-link vp-sidebar-link vp-sidebar-heading" href="/blog/project/microservice-practice/book.html#_1-å¤šæ¨¡å—ä¸å¾®æœåŠ¡"><!---->1. å¤šæ¨¡å—ä¸å¾®æœåŠ¡<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="1.1 å¤šæ¨¡å—é¡¹ç›®åŸºæœ¬ç»“æ„" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_1-1-å¤šæ¨¡å—é¡¹ç›®åŸºæœ¬ç»“æ„"><!---->1.1 å¤šæ¨¡å—é¡¹ç›®åŸºæœ¬ç»“æ„<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="1.2 å¤šæ¨¡å—æ‰“åŒ…" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_1-2-å¤šæ¨¡å—æ‰“åŒ…"><!---->1.2 å¤šæ¨¡å—æ‰“åŒ…<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a aria-label="2. å¼€å§‹æ­å»º" class="vp-link nav-link vp-sidebar-link vp-sidebar-heading nav-link vp-sidebar-link vp-sidebar-heading" href="/blog/project/microservice-practice/book.html#_2-å¼€å§‹æ­å»º"><!---->2. å¼€å§‹æ­å»º<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="2.1 æ–°å»ºé¡¹ç›® microservice-practice" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_2-1-æ–°å»ºé¡¹ç›®-microservice-practice"><!---->2.1 æ–°å»ºé¡¹ç›® microservice-practice<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.2 æ–°å»ºæ¨¡å— microservice-common" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_2-2-æ–°å»ºæ¨¡å—-microservice-common"><!---->2.2 æ–°å»ºæ¨¡å— microservice-common<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.3 æ–°å»ºæ¨¡å— microservice-api" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_2-3-æ–°å»ºæ¨¡å—-microservice-api"><!---->2.3 æ–°å»ºæ¨¡å— microservice-api<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.4 æ–°å»ºapiå­æ¨¡å— microservice-product-api" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_2-4-æ–°å»ºapiå­æ¨¡å—-microservice-product-api"><!---->2.4 æ–°å»ºapiå­æ¨¡å— microservice-product-api<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.5 æ–°å»ºapiå­æ¨¡å— microservice-order-api" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_2-5-æ–°å»ºapiå­æ¨¡å—-microservice-order-api"><!---->2.5 æ–°å»ºapiå­æ¨¡å— microservice-order-api<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.6 æ–°å»ºæ¨¡å— microservice-product" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_2-6-æ–°å»ºæ¨¡å—-microservice-product"><!---->2.6 æ–°å»ºæ¨¡å— microservice-product<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="2.7 æ–°å»ºæ¨¡å— microservice-order" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_2-7-æ–°å»ºæ¨¡å—-microservice-order"><!---->2.7 æ–°å»ºæ¨¡å— microservice-order<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a aria-label="3. åŸºç¡€æ¨¡å—ï¼ˆmicroservice-commonï¼‰" class="vp-link nav-link vp-sidebar-link vp-sidebar-heading nav-link vp-sidebar-link vp-sidebar-heading" href="/blog/project/microservice-practice/book.html#_3-åŸºç¡€æ¨¡å—-microservice-common"><!---->3. åŸºç¡€æ¨¡å—ï¼ˆmicroservice-commonï¼‰<!----></a><ul class="vp-sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a aria-label="4. å•†å“æ¨¡å—ï¼ˆmicroservice-productï¼‰" class="vp-link nav-link vp-sidebar-link vp-sidebar-heading nav-link vp-sidebar-link vp-sidebar-heading" href="/blog/project/microservice-practice/book.html#_4-å•†å“æ¨¡å—-microservice-product"><!---->4. å•†å“æ¨¡å—ï¼ˆmicroservice-productï¼‰<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="4.1 JPA+QueryDslé›†æˆ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_4-1-jpa-querydslé›†æˆ"><!---->4.1 JPA+QueryDslé›†æˆ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.2 MapStructé›†æˆ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_4-2-mapstructé›†æˆ"><!---->4.2 MapStructé›†æˆ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.3 å•†å“å¢åˆ æ”¹æŸ¥" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_4-3-å•†å“å¢åˆ æ”¹æŸ¥"><!---->4.3 å•†å“å¢åˆ æ”¹æŸ¥<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.4 åŠ¨æ€æŸ¥è¯¢+åˆ†é¡µ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_4-4-åŠ¨æ€æŸ¥è¯¢-åˆ†é¡µ"><!---->4.4 åŠ¨æ€æŸ¥è¯¢+åˆ†é¡µ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.5 åº“å­˜çš„å¢åŠ å’Œå‡å°‘" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_4-5-åº“å­˜çš„å¢åŠ å’Œå‡å°‘"><!---->4.5 åº“å­˜çš„å¢åŠ å’Œå‡å°‘<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.6 openFeignæœåŠ¡è°ƒç”¨" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_4-6-openfeignæœåŠ¡è°ƒç”¨"><!---->4.6 openFeignæœåŠ¡è°ƒç”¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="4.7 å…¨å±€å¼‚å¸¸æ‹¦æˆª" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_4-7-å…¨å±€å¼‚å¸¸æ‹¦æˆª"><!---->4.7 å…¨å±€å¼‚å¸¸æ‹¦æˆª<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a aria-label="5. è®¢å•æ¨¡å—" class="vp-link nav-link vp-sidebar-link vp-sidebar-heading nav-link vp-sidebar-link vp-sidebar-heading" href="/blog/project/microservice-practice/book.html#_5-è®¢å•æ¨¡å—"><!---->5. è®¢å•æ¨¡å—<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="5.1 è®¢å•é¢†åŸŸå±‚" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_5-1-è®¢å•é¢†åŸŸå±‚"><!---->5.1 è®¢å•é¢†åŸŸå±‚<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="5.2 è®¢å•åˆ›å»º" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_5-2-è®¢å•åˆ›å»º"><!---->5.2 è®¢å•åˆ›å»º<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a aria-label="6. å…­è¾¹å½¢æ¶æ„" class="vp-link nav-link vp-sidebar-link vp-sidebar-heading nav-link vp-sidebar-link vp-sidebar-heading" href="/blog/project/microservice-practice/book.html#_6-å…­è¾¹å½¢æ¶æ„"><!---->6. å…­è¾¹å½¢æ¶æ„<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="6.1 é¢†åŸŸå±‚ï¼ˆdomainï¼‰" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_6-1-é¢†åŸŸå±‚-domain"><!---->6.1 é¢†åŸŸå±‚ï¼ˆdomainï¼‰<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6.2 åº”ç”¨å±‚ï¼ˆApplicationï¼‰" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_6-2-åº”ç”¨å±‚-application"><!---->6.2 åº”ç”¨å±‚ï¼ˆApplicationï¼‰<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6.3 åŸºç¡€è®¾æ–½å±‚ï¼ˆInfrastructureï¼‰" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_6-3-åŸºç¡€è®¾æ–½å±‚-infrastructure"><!---->6.3 åŸºç¡€è®¾æ–½å±‚ï¼ˆInfrastructureï¼‰<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6.4 ç«¯å£ï¼ˆPortï¼‰" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_6-4-ç«¯å£-port"><!---->6.4 ç«¯å£ï¼ˆPortï¼‰<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6.5 å¤–éƒ¨æ¥å£ï¼ˆInterfaceï¼‰" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_6-5-å¤–éƒ¨æ¥å£-interface"><!---->6.5 å¤–éƒ¨æ¥å£ï¼ˆInterfaceï¼‰<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="6.6 Queryså’ŒCommands" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_6-6-queryså’Œcommands"><!---->6.6 Queryså’ŒCommands<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a aria-label="7. docker éƒ¨ç½²" class="vp-link nav-link vp-sidebar-link vp-sidebar-heading nav-link vp-sidebar-link vp-sidebar-heading" href="/blog/project/microservice-practice/book.html#_7-docker-éƒ¨ç½²"><!---->7. docker éƒ¨ç½²<!----></a><ul class="vp-sidebar-sub-headers"><li class="vp-sidebar-sub-header"><a aria-label="7.1 åˆ¶ä½œé•œåƒ" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_7-1-åˆ¶ä½œé•œåƒ"><!---->7.1 åˆ¶ä½œé•œåƒ<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="7.2 è¿è¡Œå®¹å™¨" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_7-2-è¿è¡Œå®¹å™¨"><!---->7.2 è¿è¡Œå®¹å™¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="7.3 Mysqlå®¹å™¨" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_7-3-mysqlå®¹å™¨"><!---->7.3 Mysqlå®¹å™¨<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="7.4 å¤šå®¹å™¨è¿æ¥" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_7-4-å¤šå®¹å™¨è¿æ¥"><!---->7.4 å¤šå®¹å™¨è¿æ¥<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="7.5 æ€»æµç¨‹" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_7-5-æ€»æµç¨‹"><!---->7.5 æ€»æµç¨‹<!----></a><ul class="vp-sidebar-sub-headers"></ul></li><li class="vp-sidebar-sub-header"><a aria-label="7.6 æ‹“å±•docker composeä¸€æ¬¡æ€§éƒ¨ç½²" class="vp-link nav-link vp-sidebar-link vp-heading nav-link vp-sidebar-link vp-heading" href="/blog/project/microservice-practice/book.html#_7-6-æ‹“å±•docker-composeä¸€æ¬¡æ€§éƒ¨ç½²"><!---->7.6 æ‹“å±•docker composeä¸€æ¬¡æ€§éƒ¨ç½²<!----></a><ul class="vp-sidebar-sub-headers"></ul></li></ul><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><!---->å¤šæ¨¡å—å¾®æœåŠ¡æ„å»ºéƒ¨ç½²å®æˆ˜</h1><div class="page-info"><span class="page-author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://www.jarcheng.top" target="_blank" rel="noopener noreferrer">èµ·å‡¡</a></span><span property="author" content="èµ·å‡¡"></span></span><!----><span class="page-date-info" aria-label="å†™ä½œæ—¥æœŸğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2022-11-05T00:00:00.000Z"></span><!----><span class="page-reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 28 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT28M"></span><span class="page-category-info" aria-label="åˆ†ç±»ğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item category4 clickable" role="navigation">å¤šæ¨¡å—å¾®æœåŠ¡</span><!--]--><meta property="articleSection" content="å¤šæ¨¡å—å¾®æœåŠ¡"></span><span class="page-tag-info" aria-label="æ ‡ç­¾ğŸ·" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item tag3 clickable" role="navigation">é¢†åŸŸé©±åŠ¨DDD</span><span class="page-tag-item tag5 clickable" role="navigation">å…­è¾¹å½¢æ¶æ„</span><span class="page-tag-item tag5 clickable" role="navigation">éƒ¨ç½²</span><span class="page-tag-item tag4 clickable" role="navigation">Docker</span><span class="page-tag-item tag0 clickable" role="navigation">Maven</span><!--]--><meta property="keywords" content="é¢†åŸŸé©±åŠ¨DDD,å…­è¾¹å½¢æ¶æ„,éƒ¨ç½²,Docker,Maven"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">æ­¤é¡µå†…å®¹<button type="button" class="print-button" title="æ‰“å°"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/#ä»‹ç»">ä»‹ç»</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/#_1-å¤šæ¨¡å—ä¸å¾®æœåŠ¡">1. å¤šæ¨¡å—ä¸å¾®æœåŠ¡</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_1-1-å¤šæ¨¡å—é¡¹ç›®åŸºæœ¬ç»“æ„">1.1 å¤šæ¨¡å—é¡¹ç›®åŸºæœ¬ç»“æ„</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_1-2-å¤šæ¨¡å—æ‰“åŒ…">1.2 å¤šæ¨¡å—æ‰“åŒ…</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/#_2-å¼€å§‹æ­å»º">2. å¼€å§‹æ­å»º</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_2-1-æ–°å»ºé¡¹ç›®-microservice-practice">2.1 æ–°å»ºé¡¹ç›® microservice-practice</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_2-2-æ–°å»ºæ¨¡å—-microservice-common">2.2 æ–°å»ºæ¨¡å— microservice-common</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_2-3-æ–°å»ºæ¨¡å—-microservice-api">2.3 æ–°å»ºæ¨¡å— microservice-api</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_2-4-æ–°å»ºapiå­æ¨¡å—-microservice-product-api">2.4 æ–°å»ºapiå­æ¨¡å— microservice-product-api</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_2-5-æ–°å»ºapiå­æ¨¡å—-microservice-order-api">2.5 æ–°å»ºapiå­æ¨¡å— microservice-order-api</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_2-6-æ–°å»ºæ¨¡å—-microservice-product">2.6 æ–°å»ºæ¨¡å— microservice-product</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_2-7-æ–°å»ºæ¨¡å—-microservice-order">2.7 æ–°å»ºæ¨¡å— microservice-order</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/#_3-åŸºç¡€æ¨¡å—-microservice-common">3. åŸºç¡€æ¨¡å—ï¼ˆmicroservice-commonï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/#_4-å•†å“æ¨¡å—-microservice-product">4. å•†å“æ¨¡å—ï¼ˆmicroservice-productï¼‰</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_4-1-jpa-querydslé›†æˆ">4.1 JPA+QueryDslé›†æˆ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_4-2-mapstructé›†æˆ">4.2 MapStructé›†æˆ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_4-3-å•†å“å¢åˆ æ”¹æŸ¥">4.3 å•†å“å¢åˆ æ”¹æŸ¥</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_4-4-åŠ¨æ€æŸ¥è¯¢-åˆ†é¡µ">4.4 åŠ¨æ€æŸ¥è¯¢+åˆ†é¡µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_4-5-åº“å­˜çš„å¢åŠ å’Œå‡å°‘">4.5 åº“å­˜çš„å¢åŠ å’Œå‡å°‘</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_4-6-openfeignæœåŠ¡è°ƒç”¨">4.6 openFeignæœåŠ¡è°ƒç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_4-7-å…¨å±€å¼‚å¸¸æ‹¦æˆª">4.7 å…¨å±€å¼‚å¸¸æ‹¦æˆª</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/#_5-è®¢å•æ¨¡å—">5. è®¢å•æ¨¡å—</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_5-1-è®¢å•é¢†åŸŸå±‚">5.1 è®¢å•é¢†åŸŸå±‚</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_5-2-è®¢å•åˆ›å»º">5.2 è®¢å•åˆ›å»º</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/#_6-å…­è¾¹å½¢æ¶æ„">6. å…­è¾¹å½¢æ¶æ„</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_6-1-é¢†åŸŸå±‚-domain">6.1 é¢†åŸŸå±‚ï¼ˆdomainï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_6-2-åº”ç”¨å±‚-application">6.2 åº”ç”¨å±‚ï¼ˆApplicationï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_6-3-åŸºç¡€è®¾æ–½å±‚-infrastructure">6.3 åŸºç¡€è®¾æ–½å±‚ï¼ˆInfrastructureï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_6-4-ç«¯å£-port">6.4 ç«¯å£ï¼ˆPortï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_6-5-å¤–éƒ¨æ¥å£-interface">6.5 å¤–éƒ¨æ¥å£ï¼ˆInterfaceï¼‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_6-6-queryså’Œcommands">6.6 Queryså’ŒCommands</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level2 toc-link level2" href="/blog/#_7-docker-éƒ¨ç½²">7. docker éƒ¨ç½²</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_7-1-åˆ¶ä½œé•œåƒ">7.1 åˆ¶ä½œé•œåƒ</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_7-2-è¿è¡Œå®¹å™¨">7.2 è¿è¡Œå®¹å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_7-3-mysqlå®¹å™¨">7.3 Mysqlå®¹å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_7-4-å¤šå®¹å™¨è¿æ¥">7.4 å¤šå®¹å™¨è¿æ¥</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_7-5-æ€»æµç¨‹">7.5 æ€»æµç¨‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a class="vp-link toc-link level3 toc-link level3" href="/blog/#_7-6-æ‹“å±•docker-composeä¸€æ¬¡æ€§éƒ¨ç½²">7.6 æ‹“å±•docker composeä¸€æ¬¡æ€§éƒ¨ç½²</a></li><!----><!--]--></ul></li><!--]--></ul><div class="toc-marker" style="top:-1.7rem;"></div></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><h1 id="å¤šæ¨¡å—å¾®æœåŠ¡æ„å»ºéƒ¨ç½²å®æˆ˜" tabindex="-1"><a class="header-anchor" href="#å¤šæ¨¡å—å¾®æœåŠ¡æ„å»ºéƒ¨ç½²å®æˆ˜" aria-hidden="true">#</a> å¤šæ¨¡å—å¾®æœåŠ¡æ„å»ºéƒ¨ç½²å®æˆ˜</h1><h2 id="ä»‹ç»" tabindex="-1"><a class="header-anchor" href="#ä»‹ç»" aria-hidden="true">#</a> ä»‹ç»</h2><p>æœ¬é¡¹ç›®çš„æ•™å­¦ç›®çš„æ˜¯é€šè¿‡ä¸€ä¸ªå¤šæ¨¡å—çš„é¡¹ç›®ï¼Œæ¥è®²è§£å¦‚ä½•æ­å»ºå¤šæ¨¡å—ï¼Œå¼€å‘ï¼Œéƒ¨ç½²ã€‚åˆæ¬¡ä¹‹å¤–ä½ è¿˜å¯ä»¥å­¦åˆ°å…¶ä»–é‡è¦çš„åç«¯çŸ¥è¯†ã€‚</p><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>çŸ¥è¯†æ¦‚è§ˆ</p></div><ol><li>Mavenå¤šæ¨¡å—æ„å»º</li><li>SpringBootæ‰“åŒ…æˆå¯æ‰§è¡ŒjaråŒ…</li><li>Docker Composeéƒ¨ç½²åˆ°Docker</li><li>å¾®æœåŠ¡å…­è¾¹å½¢æ¶æ„ï¼ˆé¢†åŸŸé©±åŠ¨DDDï¼‰</li><li>JPA+QueryDsl å¢åˆ æ”¹æŸ¥ï¼ŒåŠ¨æ€sqlï¼Œå¤šè¡¨join</li><li>Java Bean Validation æ•°æ®æ ¡éªŒ</li><li>MapStructä¸šåŠ¡åˆ†å±‚é—´dtoè½¬åŒ–</li></ol><h2 id="_1-å¤šæ¨¡å—ä¸å¾®æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#_1-å¤šæ¨¡å—ä¸å¾®æœåŠ¡" aria-hidden="true">#</a> 1. å¤šæ¨¡å—ä¸å¾®æœåŠ¡</h2><iframe src="//player.bilibili.com/player.html?aid=604812922&amp;bvid=BV1N84y1v7K7&amp;cid=882113458&amp;page=1" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" height="600" style="width:100%;"></iframe><h3 id="_1-1-å¤šæ¨¡å—é¡¹ç›®åŸºæœ¬ç»“æ„" tabindex="-1"><a class="header-anchor" href="#_1-1-å¤šæ¨¡å—é¡¹ç›®åŸºæœ¬ç»“æ„" aria-hidden="true">#</a> 1.1 å¤šæ¨¡å—é¡¹ç›®åŸºæœ¬ç»“æ„</h3><figure><img src="/blog/assets/dependence-bc475ff9.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>æ¨¡å—ç±»å‹ï¼š</p><ol><li>pomç±»å‹<br> è´Ÿè´£é€šä¾èµ–ç®¡ç†å’Œå­æ¨¡å—ç®¡ç†ï¼Œæ ¹æ¨¡å—å’Œapié€šä¿¡æ¨¡å—å±äºè¿™ä¸ªç±»åˆ«</li><li>jarç±»å‹<br> å¯æ‰§è¡Œçš„ï¼šè®¢å•æ¨¡å—ï¼Œå•†å“æ¨¡å—ï¼ˆäº‘æœµçŠ¶ï¼Œå¾®æœåŠ¡ï¼‰<br> ä¸å¯æ‰§è¡Œçš„ï¼šå…¶ä»–çš„ç±»åº“</li></ol><p>åœ¨å¾®æœåŠ¡å¼€å‘ä¸­ï¼Œä¸€ä¸ªé¡¹ç›®ä¸­å¾€å¾€æœ‰å¤šä¸ªæ¨¡å—ã€‚æœ‰çš„æ¨¡å—æ˜¯ä¸€ä¸ªæœåŠ¡ï¼ˆäº‘æœµçŠ¶æ¨¡å—ï¼‰ï¼Œæœ‰çš„æ¨¡å—æ˜¯å…¬ç”¨çš„ç±»åº“ï¼Œæœ‰çš„æ¨¡å—è´Ÿè´£ç®¡ç†ä¾èµ–å’Œç®¡ç†å­æ¨¡å—ã€‚</p><h3 id="_1-2-å¤šæ¨¡å—æ‰“åŒ…" tabindex="-1"><a class="header-anchor" href="#_1-2-å¤šæ¨¡å—æ‰“åŒ…" aria-hidden="true">#</a> 1.2 å¤šæ¨¡å—æ‰“åŒ…</h3><p>ä¾èµ–å›¾æ‰“åŒ…åï¼Œå˜æˆè¿™æ ·</p><figure><img src="/blog/assets/package-6aab7a9c.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><p>å•ä½“åº”ç”¨ä¹Ÿå¯ä»¥ç”¨å¤šæ¨¡å—çš„å½¢å¼å¼€å‘ï¼Œå¤šæ¨¡å—å¯ä»¥å°†æˆ‘ä»¬çš„é€šç”¨ä¸šåŠ¡é€»è¾‘åˆ†å—ï¼Œæœ€åæ‰“åŒ…æ—¶åˆå¹¶æˆä¸€ä¸ªå¯æ‰§è¡Œçš„jaråŒ…</p><p>å¾®æœåŠ¡é¡¹ç›®é‡‡ç”¨å¤šæ¨¡å—å¼€å‘æ—¶ï¼Œæ¯ä¸ªå¾®æœåŠ¡éƒ½å¯ä»¥çœ‹æˆä¸€ä¸ªå•ä½“åº”ç”¨ï¼Œæœ€åæ¯ä¸ªå¾®æœåŠ¡åˆå¹¶æ‰€æœ‰ä¾èµ–æ‰“åŒ…æˆå¯æ‰§è¡Œçš„jaråŒ…ã€‚<br> å¾®æœåŠ¡ä¸å¾®æœåŠ¡ä¹‹é—´åœ¨jaråŒ…å±‚é¢æ˜¯ä¸èƒ½äº’ç›¸å¼•ç”¨çš„ã€‚å®ƒä»¬ä¹‹é—´é€šè¿‡openFeignè¿œç¨‹è°ƒç”¨ï¼ˆä¹Ÿå¯ä»¥æ˜¯åˆ«çš„è¿œç¨‹è°ƒç”¨åè®®ï¼‰ã€‚</p><h2 id="_2-å¼€å§‹æ­å»º" tabindex="-1"><a class="header-anchor" href="#_2-å¼€å§‹æ­å»º" aria-hidden="true">#</a> 2. å¼€å§‹æ­å»º</h2><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>å¼€å‘ç¯å¢ƒ</p></div><ol><li>maven3.8ï¼ˆéœ€è¦é…ç½®é•œåƒï¼‰</li><li>jdk11</li><li>idea2022.2ï¼ˆä¸æ‡‚æ¿€æ´»å¯ä»¥é—®æˆ‘ï¼‰</li></ol><ul><li>microservice-practice <ul><li>microservice-common</li><li>microservice-api <ul><li>microservice-product-api</li><li>microservice-order-api</li></ul></li><li>microservice-product</li><li>microservice-order</li></ul></li></ul><h3 id="_2-1-æ–°å»ºé¡¹ç›®-microservice-practice" tabindex="-1"><a class="header-anchor" href="#_2-1-æ–°å»ºé¡¹ç›®-microservice-practice" aria-hidden="true">#</a> 2.1 æ–°å»ºé¡¹ç›® microservice-practice</h3><ol><li><p>å£°æ˜ç‰ˆæœ¬å·</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>revision</span><span class="token punctuation">&gt;</span></span>1.0-SNAPSHOT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>revision</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>è¯»å–ç‰ˆæœ¬</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.qifan.microservice<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>microservice-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${revision}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æŒ‡å®šçˆ¶äº²</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.7.5<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>packageæ”¹ä¸º<code>pom</code></p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packaging</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packaging</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ç®¡ç†å­æ¨¡å—ï¼ˆéœ€è¦å­æ¨¡å—åˆ›å»ºå®Œå†æ·»åŠ ï¼‰</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modules</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">&gt;</span></span>microservice-common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">&gt;</span></span>microservice-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">&gt;</span></span>z
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">&gt;</span></span>microservice-order<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">&gt;</span></span>microservice-product<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modules</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>æ³¨æ„ï¼šä¸‹é¢çš„æ¨¡å—åä¸artifactIdåŒåï¼Œå¹¶ä¸”groupIdä¸é¡¹ç›®çš„groupIdä¸€è‡´ã€‚</p><h3 id="_2-2-æ–°å»ºæ¨¡å—-microservice-common" tabindex="-1"><a class="header-anchor" href="#_2-2-æ–°å»ºæ¨¡å—-microservice-common" aria-hidden="true">#</a> 2.2 æ–°å»ºæ¨¡å— microservice-common</h3><ol><li><p>æŒ‡å®šçˆ¶äº²æ¨¡å—</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>microservice-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.qifan.microservice<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${revision}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="_2-3-æ–°å»ºæ¨¡å—-microservice-api" tabindex="-1"><a class="header-anchor" href="#_2-3-æ–°å»ºæ¨¡å—-microservice-api" aria-hidden="true">#</a> 2.3 æ–°å»ºæ¨¡å— microservice-api</h3><ol><li><p>æŒ‡å®šçˆ¶äº²æ¨¡å—</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>microservice-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.qifan.microservice<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${revision}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>packageæ”¹ä¸ºpom</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packaging</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packaging</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>ç®¡ç†å­æ¨¡å—ï¼ˆéœ€è¦å­æ¨¡å—åˆ›å»ºå®Œå†æ·»åŠ ï¼‰</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modules</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">&gt;</span></span>infrastructure-product-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>module</span><span class="token punctuation">&gt;</span></span>infrastructure-order-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>module</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modules</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="_2-4-æ–°å»ºapiå­æ¨¡å—-microservice-product-api" tabindex="-1"><a class="header-anchor" href="#_2-4-æ–°å»ºapiå­æ¨¡å—-microservice-product-api" aria-hidden="true">#</a> 2.4 æ–°å»ºapiå­æ¨¡å— microservice-product-api</h3><ol><li><p>æŒ‡å®šçˆ¶äº²æ¨¡å—</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>microservice-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.qifan.microservice<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${revision}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="_2-5-æ–°å»ºapiå­æ¨¡å—-microservice-order-api" tabindex="-1"><a class="header-anchor" href="#_2-5-æ–°å»ºapiå­æ¨¡å—-microservice-order-api" aria-hidden="true">#</a> 2.5 æ–°å»ºapiå­æ¨¡å— microservice-order-api</h3><ol><li><p>æŒ‡å®šçˆ¶äº²æ¨¡å—</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>microservice-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.qifan.microservice<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${revision}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h3 id="_2-6-æ–°å»ºæ¨¡å—-microservice-product" tabindex="-1"><a class="header-anchor" href="#_2-6-æ–°å»ºæ¨¡å—-microservice-product" aria-hidden="true">#</a> 2.6 æ–°å»ºæ¨¡å— microservice-product</h3><ol><li><p>æŒ‡å®šçˆ¶äº²æ¨¡å—</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>microservice-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.qifan.microservice<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
     <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${revision}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æ·»åŠ springbootæ‰“åŒ…æ’ä»¶</p><p>è¦è®©è¿™ä¸ª<code>spring boot</code>æ¨¡å—æ‰“åŒ…ä¹‹åæ˜¯æ˜¯å¯ä»¥æ‰§è¡Œï¼Œéœ€è¦æ·»åŠ ä¸‹é¢è¿™ä¸ªæ’ä»¶ã€‚</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼šåªæœ‰<code>spring boot</code>æ¨¡å—æ‰èƒ½ä½¿ç”¨è¿™ä¸ªæ’ä»¶ã€‚</p></li></ol><h3 id="_2-7-æ–°å»ºæ¨¡å—-microservice-order" tabindex="-1"><a class="header-anchor" href="#_2-7-æ–°å»ºæ¨¡å—-microservice-order" aria-hidden="true">#</a> 2.7 æ–°å»ºæ¨¡å— microservice-order</h3><p><strong>æ“ä½œå’Œä¸Šé¢ä¸€æ ·</strong></p><h2 id="_3-åŸºç¡€æ¨¡å—-microservice-common" tabindex="-1"><a class="header-anchor" href="#_3-åŸºç¡€æ¨¡å—-microservice-common" aria-hidden="true">#</a> 3. åŸºç¡€æ¨¡å—ï¼ˆmicroservice-commonï¼‰</h2><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>é€šç”¨çš„æšä¸¾æ¥å£</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BaseEnum</span> <span class="token punctuation">{</span>

    <span class="token class-name">Integer</span> <span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>å¼‚å¸¸æšä¸¾å€¼</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">ResultCode</span> <span class="token keyword">implements</span> <span class="token class-name">BaseEnum</span> <span class="token punctuation">{</span>
    <span class="token class-name">Success</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;æ“ä½œæˆåŠŸ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">Fail</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;æ“ä½œå¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">NotFindError</span><span class="token punctuation">(</span><span class="token number">10001</span><span class="token punctuation">,</span> <span class="token string">&quot;æœªæŸ¥è¯¢åˆ°ä¿¡æ¯&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">SaveError</span><span class="token punctuation">(</span><span class="token number">10002</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¿å­˜ä¿¡æ¯å¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">UpdateError</span><span class="token punctuation">(</span><span class="token number">10003</span><span class="token punctuation">,</span> <span class="token string">&quot;æ›´æ–°ä¿¡æ¯å¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">ValidateError</span><span class="token punctuation">(</span><span class="token number">10004</span><span class="token punctuation">,</span> <span class="token string">&quot;æ•°æ®æ£€éªŒå¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">StatusHasValid</span><span class="token punctuation">(</span><span class="token number">10005</span><span class="token punctuation">,</span> <span class="token string">&quot;çŠ¶æ€å·²ç»è¢«å¯ç”¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">StatusHasInvalid</span><span class="token punctuation">(</span><span class="token number">10006</span><span class="token punctuation">,</span> <span class="token string">&quot;çŠ¶æ€å·²ç»è¢«ç¦ç”¨&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">SystemError</span><span class="token punctuation">(</span><span class="token number">10007</span><span class="token punctuation">,</span> <span class="token string">&quot;ç³»ç»Ÿå¼‚å¸¸&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">BusinessError</span><span class="token punctuation">(</span><span class="token number">10008</span><span class="token punctuation">,</span> <span class="token string">&quot;ä¸šåŠ¡å¼‚å¸¸&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">ParamSetIllegal</span><span class="token punctuation">(</span><span class="token number">10009</span><span class="token punctuation">,</span> <span class="token string">&quot;å‚æ•°è®¾ç½®éæ³•&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">TransferStatusError</span><span class="token punctuation">(</span><span class="token number">10010</span><span class="token punctuation">,</span> <span class="token string">&quot;å½“å‰çŠ¶æ€ä¸æ­£ç¡®ï¼Œè¯·å‹¿é‡å¤æäº¤&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token class-name">NotGrant</span><span class="token punctuation">(</span><span class="token number">10011</span><span class="token punctuation">,</span> <span class="token string">&quot;æ²¡æœ‰æ“ä½œè¯¥åŠŸèƒ½çš„æƒé™ï¼Œè¯·è”ç³»ç®¡ç†å‘˜&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * codeçš„å–å€¼è§„åˆ™ï¼Œxxä»£è¡¨æ¨¡å—ï¼Œxxxä»£è¡¨åŠŸèƒ½å¼‚å¸¸ ä¾‹å¦‚ï¼šåŸºç¡€æ¨¡å—ï¼ˆ10ï¼‰çš„æŸ¥è¯¢å¼‚å¸¸ï¼ˆ001ï¼‰
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> code<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * å¼‚å¸¸ä¿¡æ¯
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token class-name">ResultCode</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> code<span class="token punctuation">,</span> <span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>code<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ResultCode</span><span class="token punctuation">&gt;</span></span> <span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token class-name">ResultCode</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>resultCode <span class="token operator">-&gt;</span> resultCode<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>ä¸šåŠ¡å¼‚å¸¸</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä¸šåŠ¡å¼‚å¸¸ï¼Œéœ€è¦è¿”å›ç»™ç”¨æˆ·çœ‹çš„
 */</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BusinessException</span> <span class="token keyword">extends</span> <span class="token class-name">RuntimeException</span> <span class="token punctuation">{</span>
    <span class="token class-name">ResultCode</span> resultCode<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">BusinessException</span><span class="token punctuation">(</span><span class="token class-name">ResultCode</span> resultCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>resultCode<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>resultCode <span class="token operator">=</span> resultCode<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">BusinessException</span><span class="token punctuation">(</span><span class="token class-name">ResultCode</span> resultCode<span class="token punctuation">,</span> <span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>resultCode <span class="token operator">=</span> resultCode<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>ç³»ç»Ÿå¼‚å¸¸</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ç³»ç»Ÿå¼‚å¸¸ï¼Œä¸éœ€è¦ç»™ç”¨æˆ·çœ‹
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SystemException</span> <span class="token keyword">extends</span> <span class="token class-name">RuntimeException</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">SystemException</span><span class="token punctuation">(</span><span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>é€šä¸€è¿”å›ç»“æœ</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> <span class="token number">1L</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">Integer</span> code<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">String</span> msg<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token class-name">T</span> result<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        
    <span class="token punctuation">}</span>


    <span class="token keyword">private</span> <span class="token class-name">R</span><span class="token punctuation">(</span><span class="token class-name">T</span> result<span class="token punctuation">,</span> <span class="token class-name">Integer</span> code<span class="token punctuation">,</span> <span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>result <span class="token operator">=</span> result<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> code<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> msg<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">private</span> <span class="token class-name">R</span><span class="token punctuation">(</span><span class="token class-name">T</span> result<span class="token punctuation">,</span> <span class="token class-name">ResultCode</span> resultCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>result <span class="token operator">=</span> result<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>msg <span class="token operator">=</span> resultCode<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>code <span class="token operator">=</span> resultCode<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> <span class="token class-name">ResultCode<span class="token punctuation">.</span>Success</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token function">ok</span><span class="token punctuation">(</span><span class="token class-name">T</span> data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token class-name">ResultCode<span class="token punctuation">.</span>Success</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">fail</span><span class="token punctuation">(</span><span class="token class-name">ResultCode</span> resultCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> resultCode<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">fail</span><span class="token punctuation">(</span><span class="token class-name">ResultCode</span> resultCode<span class="token punctuation">,</span> <span class="token class-name">String</span> msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> resultCode<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">isSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">ResultCode<span class="token punctuation">.</span>Success</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>åŸºç¡€Entity</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>
<span class="token doc-comment comment">/**
 * åŸºç¡€çš„entityã€‚
 * æœ‰å¦‚ä¸‹ä½œç”¨
 * 1. æ¯æ¬¡æ’å…¥å‰è°ƒç”¨<span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token punctuation">#</span><span class="token function">prePersist</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span>æ¥åˆå§‹åŒ–åˆ›å»ºæ—¶é—´å’Œæ›´æ–°æ—¶é—´å¹¶å®Œæˆæ•°æ®æ ¡éªŒã€‚
 * 2. æ¯æ¬¡æ›´æ–°å‰è°ƒç”¨<span class="token punctuation">{</span><span class="token keyword">@link</span> <span class="token reference"><span class="token punctuation">#</span><span class="token function">preUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span><span class="token punctuation">}</span>æ¥åˆå§‹åŒ–æ›´æ–°æ—¶é—´å¹¶å®Œæˆæ•°æ®æ ¡éªŒ
 * 3. idè‡ªå¢
 * 4. versionä¹è§‚é”ï¼Œå¹¶å‘æ§åˆ¶
 */</span>
<span class="token annotation punctuation">@MappedSuperclass</span>
<span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@ToString</span>
<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">BaseEntity</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractAggregateRoot</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BaseEntity</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Validator</span> validator <span class="token operator">=</span> <span class="token class-name">Validation</span><span class="token punctuation">.</span><span class="token function">buildDefaultValidatorFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getValidator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token annotation punctuation">@Id</span>
    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> <span class="token class-name">GenerationType</span><span class="token punctuation">.</span><span class="token constant">AUTO</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;created_at&quot;</span><span class="token punctuation">,</span> nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> updatable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> createdAt<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;updated_at&quot;</span><span class="token punctuation">,</span> nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">LocalDateTime</span> updatedAt<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Version</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;version&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> version<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PrePersist</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">prePersist</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">doValidate</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setCreatedAt</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">setUpdatedAt</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PreUpdate</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">preUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">doValidate</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setUpdatedAt</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> o<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token class-name">Hibernate</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token class-name">Hibernate</span><span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token class-name">BaseEntity</span> that <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">BaseEntity</span><span class="token punctuation">)</span> o<span class="token punctuation">;</span>
        <span class="token keyword">return</span> id <span class="token operator">!=</span> <span class="token keyword">null</span> <span class="token operator">&amp;&amp;</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> that<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">void</span> <span class="token function">doValidate</span><span class="token punctuation">(</span><span class="token class-name">T</span> t<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Set</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ConstraintViolation</span><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> constraintViolations <span class="token operator">=</span> validator<span class="token punctuation">.</span><span class="token function">validate</span><span class="token punctuation">(</span>t<span class="token punctuation">,</span> <span class="token class-name">Default</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>constraintViolations<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ConstraintViolationException</span><span class="token punctuation">(</span>constraintViolations<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>åŸºç¡€Repository</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>
<span class="token doc-comment comment">/**
 * åŸºç¡€repositoryï¼Œå…¶ä»–å®ä½“ç±»çš„repositoryåªéœ€ç»§æ‰¿è¿™ä¸ªç±»å°±æ‹¥æœ‰å¢åˆ æ”¹æŸ¥ï¼ŒåŠ¨æ€sqlçš„åŠŸèƒ½ã€‚
 * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">&lt;</span>T<span class="token punctuation">&gt;</span></span>
 */</span>
<span class="token annotation punctuation">@NoRepositoryBean</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BaseRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">extends</span> <span class="token class-name">JpaRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">,</span> <span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">JpaSpecificationExecutor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">,</span> <span class="token class-name">QuerydslPredicateExecutor</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">T</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_4-å•†å“æ¨¡å—-microservice-product" tabindex="-1"><a class="header-anchor" href="#_4-å•†å“æ¨¡å—-microservice-product" aria-hidden="true">#</a> 4. å•†å“æ¨¡å—ï¼ˆmicroservice-productï¼‰</h2><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>çŸ¥è¯†æ¦‚è§ˆ</p></div><ol><li>å…¨å±€å¼‚å¸¸æ‹¦æˆª</li><li>æ•°æ®æ ¡éªŒ</li><li>apiæ–‡æ¡£</li><li>mapstruct</li><li>å‡½æ•°å¼ç¼–ç¨‹</li><li>jpa</li></ol><h3 id="_4-1-jpa-querydslé›†æˆ" tabindex="-1"><a class="header-anchor" href="#_4-1-jpa-querydslé›†æˆ" aria-hidden="true">#</a> 4.1 JPA+QueryDslé›†æˆ</h3><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>pomä¾èµ–</p></div><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>io.qifan.microservice<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>microservice-common<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${revision}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.querydsl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>querydsl-apt<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.querydsl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>querydsl-jpa<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- queryDslç”ŸæˆæŸ¥è¯¢ç±» --&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.mysema.maven<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>apt-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.1.3<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executions</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>execution</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goals</span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goal</span><span class="token punctuation">&gt;</span></span>process<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goal</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goals</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>outputDirectory</span><span class="token punctuation">&gt;</span></span>target/generated-sources/java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>outputDirectory</span><span class="token punctuation">&gt;</span></span>
                            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>processor</span><span class="token punctuation">&gt;</span></span>com.querydsl.apt.jpa.JPAAnnotationProcessor<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>processor</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>execution</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executions</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>spring bootå¯åŠ¨ç±»</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span></span><span class="token punctuation">;</span>
<span class="token comment">//TODO å‡ºç°æ¨¡å—ä¾èµ–å¼‚å¸¸æ—¶ï¼Œåˆ æ‰.idea é‡æ–°æ‰“å¼€é¡¹ç›®</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProductApplication</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">ProductApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>package-info</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@QueryEntities</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">BaseEntity</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">package</span> <span class="token namespace">io<span class="token punctuation">.</span>qifan<span class="token punctuation">.</span>microservice<span class="token punctuation">.</span>product</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>querydsl<span class="token punctuation">.</span>core<span class="token punctuation">.</span>annotations<span class="token punctuation">.</span></span><span class="token class-name">QueryEntities</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>qifan<span class="token punctuation">.</span>microservice<span class="token punctuation">.</span>common<span class="token punctuation">.</span>jpa<span class="token punctuation">.</span></span><span class="token class-name">BaseEntity</span></span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>application.yml é…ç½®ç«¯å£</p></div><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">9000</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">profiles</span><span class="token punctuation">:</span>
    <span class="token key atrule">active</span><span class="token punctuation">:</span> dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>application-dev.yml é…ç½®æ•°æ®åº“</p></div><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/microservice
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token string">&#39;123456&#39;</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
  <span class="token key atrule">jpa</span><span class="token punctuation">:</span>
    <span class="token key atrule">hibernate</span><span class="token punctuation">:</span>
      <span class="token key atrule">ddl-auto</span><span class="token punctuation">:</span> update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>å•†å“entity</p></div><p>entityæ˜¯ä¸€ä¸ªæœåŠ¡çš„æ ¸å¿ƒï¼Œæ‰€æœ‰ä¸šåŠ¡éƒ½æ˜¯å›´ç»•entityåœ¨è½¬ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;goods&quot;</span><span class="token punctuation">,</span> indexes <span class="token operator">=</span> <span class="token annotation punctuation">@Index</span><span class="token punctuation">(</span>columnList <span class="token operator">=</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span> unique <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Goods</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * nullï¼Œ&quot;&quot;éƒ½ä¼šæŠ¥é”™
     */</span>
    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å•†å“åç§°ä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * ä»·æ ¼è¦ç”¨BigDecimal
     * æœ€å¤§èŒƒå›´+-99999999.99
     */</span>
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;ä»·æ ¼ä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@DecimalMin</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;0.01&quot;</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;ä»·æ ¼&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> precision <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">,</span> scale <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> price<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å°é¢ä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> cover<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;åº“å­˜ä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Min</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;åº“å­˜ä¸èƒ½ä¸ºè´Ÿæ•°&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> stock<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>å•†å“repository</p></div><p>åŸºç¡€å¢åˆ æ”¹æŸ¥</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">GoodsRepository</span> <span class="token keyword">extends</span> <span class="token class-name">BaseRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Goods</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>æ‰“åŒ…+ç¼–è¯‘</p></div><ol><li>å³ä¾§maven-&gt; microservice-parent -&gt; lifecycle-&gt; install</li><li>maven-&gt; microservice-parent -&gt; lifecycle-&gt; compile</li></ol><p>æ³¨æ„ï¼šéœ€è¦åˆ æ‰æ³¨é‡Šæ‰ microservice-orderçš„ <code>build</code> æ ‡ç­¾</p><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>æµ‹è¯•</p></div><p>ä¾æ¬¡è¿è¡Œä¸‹é¢ä¸¤ä¸ªæµ‹è¯•æ–¹æ³•ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootTest</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GoodsTest</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">GoodsRepository</span> goodsRepository<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">createTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Goods</span> goods <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Goods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods<span class="token punctuation">.</span><span class="token function">setCover</span><span class="token punctuation">(</span><span class="token string">&quot;https://www.jarcheng.top/blog/qifan_logo.jpg&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;æµ‹è¯•å•†å“&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods<span class="token punctuation">.</span><span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">TEN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods<span class="token punctuation">.</span><span class="token function">setStock</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> save <span class="token operator">=</span> goodsRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>goods<span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æ’å…¥å•†å“ï¼š{}&quot;</span><span class="token punctuation">,</span> save<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findByName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        goodsRepository<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token class-name">QGoods</span><span class="token punctuation">.</span>goods<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token string">&quot;æµ‹è¯•å•†å“&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">ifPresent</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Goods</span> goods<span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
                    log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>goods<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-2-mapstructé›†æˆ" tabindex="-1"><a class="header-anchor" href="#_4-2-mapstructé›†æˆ" aria-hidden="true">#</a> 4.2 MapStructé›†æˆ</h3><p>åœ¨å…­è¾¹å½¢æ¶æ„ä¸­ï¼Œåº”ç”¨å±‚å’Œå¤–éƒ¨æ²Ÿé€šæ˜¯é€šè¿‡dtoï¼Œè€Œå’Œé¢†åŸŸå±‚æ˜¯é€šè¿‡entityã€‚æ‰€ä»¥åœ¨åº”ç”¨å±‚æˆ‘ä»¬éœ€è¦å°†dtoè½¬æˆentityï¼ŒæŠŠentityè½¬æˆdtoã€‚</p><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>å®šä¹‰æ¦‚å¿µ</p></div><ol><li>requestï¼šä¼ è¿›æ¥çš„dto</li><li>responseï¼šè¿”å›å‡ºå»çš„dto</li><li>entityï¼šå®ä½“ç±»ï¼Œå’Œæ•°æ®åº“ç›¸å¯¹åº”ã€‚</li><li>mapperï¼šæ˜ å°„ç±»ï¼Œå°†requestæ˜ å°„æˆentityæˆ–è€…å°†entityæ˜ å°„æˆresponse</li></ol><p>mapstructä¸»è¦ä½œç”¨å°±æ˜¯åœ¨mapperè¿™è¾¹åšæ˜ å°„ã€‚</p><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>pom å¯¼å…¥ä¾èµ–</p></div><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mapstruct<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mapstruct<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${mapstruct.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>pomå¯¼å…¥æ’ä»¶</p></div><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>maven-compiler-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${maven-compiler-plugin.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>source</span><span class="token punctuation">&gt;</span></span>11<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>source</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>target</span><span class="token punctuation">&gt;</span></span>11<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>target</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>annotationProcessorPaths</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.mapstruct<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mapstruct-processor<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${mapstruct.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>path</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${lombok.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>path</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>path</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok-mapstruct-binding<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>0.2.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>path</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>annotationProcessorPaths</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>GoodsCreateRequest åˆ›å»ºå•†å“è¯·æ±‚</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GoodsCreateRequest</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å•†å“åç§°ä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;ä»·æ ¼ä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@DecimalMin</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;0.01&quot;</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;ä»·æ ¼&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> price<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å°é¢ä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> cover<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;åº“å­˜ä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Min</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;åº“å­˜ä¸èƒ½ä¸ºè´Ÿæ•°&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> stock<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>GoodsMapper æ˜ å°„ç±»</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">GoodsMapper</span> <span class="token punctuation">{</span>
    <span class="token class-name">GoodsMapper</span> <span class="token constant">INSTANCE</span> <span class="token operator">=</span> <span class="token class-name">Mappers</span><span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">GoodsMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Goods</span> <span class="token function">createRequest2Entity</span><span class="token punctuation">(</span><span class="token class-name">GoodsCreateRequest</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>mavenç¼–è¯‘</p></div><p>å³ä¾§maven-&gt; microservcie-parent -&gt; lifecycle -&gt; compile</p><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>æµ‹è¯•</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GoodsDemoTest</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">GoodsRepository</span> goodsRepository<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">mapperTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åˆ›å»ºè¯·æ±‚dto</span>
        <span class="token class-name">GoodsCreateRequest</span> goodsCreateRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GoodsCreateRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsCreateRequest<span class="token punctuation">.</span><span class="token function">setCover</span><span class="token punctuation">(</span><span class="token string">&quot;http://xxxx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsCreateRequest<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;ç¬”è®°æœ¬&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsCreateRequest<span class="token punctuation">.</span><span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">TEN</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsCreateRequest<span class="token punctuation">.</span><span class="token function">setStock</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;è½¬æ¢å‰ï¼š{}&quot;</span><span class="token punctuation">,</span> goodsCreateRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> goods <span class="token operator">=</span> <span class="token class-name">GoodsMapper</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">.</span><span class="token function">createRequest2Entity</span><span class="token punctuation">(</span>goodsCreateRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;è½¬æ¢åï¼š{}&quot;</span><span class="token punctuation">,</span> goods<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> save <span class="token operator">=</span> goodsRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>goods<span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;entityæ’å…¥åˆ°æ•°æ®åº“ï¼š{}&quot;</span><span class="token punctuation">,</span> save<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-3-å•†å“å¢åˆ æ”¹æŸ¥" tabindex="-1"><a class="header-anchor" href="#_4-3-å•†å“å¢åˆ æ”¹æŸ¥" aria-hidden="true">#</a> 4.3 å•†å“å¢åˆ æ”¹æŸ¥</h3><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>GoodsApplication Serviceï¼ˆåº”ç”¨å±‚æœåŠ¡ï¼‰</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Transactional</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GoodsApplicationService</span> <span class="token punctuation">{</span>
    <span class="token comment">// @RequiredArgsConstructor + final ä¼šè‡ªåŠ¨æ³¨å…¥ã€‚</span>
    <span class="token comment">// ä¸éœ€è¦@Autowired</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">GoodsRepository</span> goodsRepository<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">GoodsCreateRequest</span> createRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// MapStructï¼ŒGoodsCreateRequestè½¬æˆGoods(dto-&gt; entity)</span>
        <span class="token class-name">Goods</span> goods <span class="token operator">=</span> <span class="token class-name">GoodsMapper</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">.</span><span class="token function">createRequest2Entity</span><span class="token punctuation">(</span>createRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Goods</span> saveResult <span class="token operator">=</span> goodsRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>goods<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// saveResult å’Œ goodsæ˜¯åŒä¸€ä¸ªå¯¹è±¡</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;åˆ›å»ºå•†å“ï¼š{}&quot;</span><span class="token punctuation">,</span> saveResult<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> goods<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">GoodsUpdateRequest</span> updateRequest<span class="token punctuation">,</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¿™ä¸ªgoodsè‚¯å®šä¸ä¸ºnullï¼Œå¦‚æœä¸ºnullä¸‹é¢ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå°±ä¸ä¼šè¿”å›ç»“æœã€‚</span>
        <span class="token class-name">Goods</span> goods <span class="token operator">=</span> goodsRepository
                <span class="token comment">// å…ˆæŸ¥æ‰¾è¦æ›´æ–°çš„entity</span>
                <span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
                <span class="token comment">// å¦‚æœä¸ºç©ºåˆ™æŠ›å‡ºå¼‚å¸¸</span>
                <span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">BusinessException</span><span class="token punctuation">(</span><span class="token class-name">ResultCode<span class="token punctuation">.</span>NotFindError</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


        <span class="token comment">/*
         å‡è®¾æˆ‘è¦æ›´æ–°å°é¢å’Œä»·æ ¼ï¼Œæ­£å¸¸æ˜¯è¿™æ ·å†™çš„ã€‚
         å°é¢å’Œä»·æ ¼ä¸ä¸ºç©ºï¼Œåˆ™æ›´æ–°entityï¼Œç„¶åæ›´æ–°æ•°æ®åº“ã€‚
         if (StringUtils.isNotBlank(updateRequest.getCover())) {
             goods.setCover(updateRequest.getCover());
          }
         if (updateRequest.getPrice()!=null) {
            goods.setPrice(goods.getPrice());
          }
         goodsRepository.save(goods);
         æ˜¾ç„¶ä¸Šé¢è¿™ç§å†™æ³•å¾ˆä¸‘
        */</span>

        <span class="token comment">// ä½¿ç”¨mapstructä¸€è¡Œæå®šï¼Œç”¨æ›´æ–°è¯·æ±‚å»æ›´æ–°entityã€‚</span>
        <span class="token class-name">GoodsMapper</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">.</span><span class="token function">updateEntityFromUpdateRequest</span><span class="token punctuation">(</span>updateRequest<span class="token punctuation">,</span> goods<span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>goods<span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æ›´æ–°å•†å“ï¼š{}&quot;</span><span class="token punctuation">,</span> goods<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">GoodsResponse</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Goods</span> goods <span class="token operator">=</span> goodsRepository
                <span class="token comment">// æŸ¥æ‰¾</span>
                <span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span>
                <span class="token comment">// ä¸ºç©ºåˆ™æŠ›å‡ºå¼‚å¸¸</span>
                <span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">BusinessException</span><span class="token punctuation">(</span><span class="token class-name">ResultCode<span class="token punctuation">.</span>NotFindError</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å°†entityè½¬æˆresponse</span>
        <span class="token keyword">return</span> <span class="token class-name">GoodsMapper</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">.</span><span class="token function">entity2Response</span><span class="token punctuation">(</span>goods<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GoodsResponse</span><span class="token punctuation">&gt;</span></span> <span class="token function">findAllById</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> ids<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æ ¹æ®å¤šä¸ªidæŸ¥è¯¢å¤šä¸ªå•†å“</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Goods</span><span class="token punctuation">&gt;</span></span> goodsList <span class="token operator">=</span> goodsRepository<span class="token punctuation">.</span><span class="token function">findAllById</span><span class="token punctuation">(</span>ids<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å°†List&lt;Goods&gt; -&gt; List&lt;GoodsResponse&gt;</span>
        <span class="token keyword">return</span> goodsList<span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">GoodsMapper</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token operator">::</span><span class="token function">entity2Response</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>GoodsController</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;goods&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GoodsController</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">GoodsApplicationService</span> goodsApplicationService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;findById/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GoodsResponse</span><span class="token punctuation">&gt;</span></span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>goodsApplicationService<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;create&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token annotation punctuation">@Valid</span> <span class="token class-name">GoodsCreateRequest</span> createRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>goodsApplicationService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createRequest<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;update/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">GoodsUpdateRequest</span> updateRequest<span class="token punctuation">,</span> <span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        goodsApplicationService<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>updateRequest<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>


    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;findAllById&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">GoodsResponse</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">findAllById</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> ids<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>goodsApplicationService<span class="token punctuation">.</span><span class="token function">findAllById</span><span class="token punctuation">(</span>ids<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>æµ‹è¯•</p></div><p>æµ‹è¯•ä½¿ç”¨ideaè‡ªå¸¦çš„http clientã€‚</p><p>åœ¨controllerä¸­ï¼Œé€‰æ‹©è¦æµ‹è¯•çš„æ¥å£ï¼Œå·¦ä¾§æœ‰ä¸€ä¸ªå›¾æ ‡ï¼Œç‚¹å‡»ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªè¯·æ±‚åœ°å€ã€‚</p><p>è¿è¡Œä¸‹é¢çš„æµ‹è¯•è¯·æ±‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>### åˆ›å»ºå•†å“
POST http://localhost:9000/goods/create
Content-Type: application/json

{
  &quot;name&quot;: &quot;åä¸ºæ‰‹æœº&quot;,
  &quot;price&quot;: 5800,
  &quot;cover&quot;: &quot;http://xxx123&quot;,
  &quot;stock&quot;: 100
}


### æ ¹æ®idæ‰¹é‡æŸ¥æ‰¾å•†å“

POST http://localhost:9000/goods/findAllById
Content-Type: application/json

[49,48,46]


### æ›´æ–°å•†å“

POST http://localhost:9000/goods/update/49
Content-Type: application/json


{
  &quot;stock&quot;: 200
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-4-åŠ¨æ€æŸ¥è¯¢-åˆ†é¡µ" tabindex="-1"><a class="header-anchor" href="#_4-4-åŠ¨æ€æŸ¥è¯¢-åˆ†é¡µ" aria-hidden="true">#</a> 4.4 åŠ¨æ€æŸ¥è¯¢+åˆ†é¡µ</h3><p>å‰ç«¯æŸ¥è¯¢çš„æ—¶å€™å¯èƒ½ä¸åŠ ä»»ä½•çš„è¿‡æ»¤æ¡ä»¶ï¼Œä¹Ÿå¯èƒ½ä¼šæ·»åŠ éƒ¨åˆ†è¿‡æ»¤æ¡ä»¶ã€‚<br> æˆ‘ä»¬ä½¿ç”¨queryDslæ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚</p><p>åœºæ™¯ï¼šå‰ç«¯æƒ³æ ¹æ®å•†å“åç§°åˆ†é¡µæŸ¥è¯¢ï¼Œä¹Ÿå¯èƒ½ä¸è¦å•†å“åç§°ç›´æ¥åˆ†é¡µæŸ¥è¯¢ã€‚</p><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>æŸ¥è¯¢è¯·æ±‚dto</p></div><p>è¿™ä¸ªdtoæ˜¯é¢å‘å‰ç«¯çš„ã€‚è€Œåç«¯æ˜¯é¢å‘å®ä½“ç±»ã€‚åˆ°æ—¶å€™éœ€è¦ç”¨åˆ°mapstructæ˜ å°„ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GoodsQueryRequest</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>GoodsMapper</p></div><p>æ–°å¢ä¸‹é¢çš„æ–¹æ³•ï¼ŒåšGoodsQueryRequest-&gt;Goodsæ˜ å°„ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token class-name">QueryRequest</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Goods</span><span class="token punctuation">&gt;</span></span> <span class="token function">queryRequest2Entity</span><span class="token punctuation">(</span><span class="token class-name">QueryRequest</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GoodsQueryRequest</span><span class="token punctuation">&gt;</span></span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>domain service</p></div><p>åŠ¨æ€æŸ¥è¯¢å…·æœ‰åˆ¤æ–­é€»è¾‘ï¼Œå¯èƒ½ä¼šæœ‰æ‹“å±•æ€§ï¼Œä¸é€‚åˆæ”¾åœ¨ application serviceã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GoodsService</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * <span class="token keyword">@param</span> <span class="token parameter">queryRequest</span>ï¼ˆåˆ†é¡µæ¡ä»¶+éœ€è¦è¿‡æ»¤çš„æ¡ä»¶ï¼‰
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Goods</span><span class="token punctuation">&gt;</span></span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryRequest</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Goods</span><span class="token punctuation">&gt;</span></span> queryRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// åŠ¨æ€çš„è¿‡æ»¤æ¡ä»¶</span>
        <span class="token class-name">BooleanBuilder</span> booleanBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BooleanBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// å¦‚æœå­˜åœ¨å•†å“åç§°åˆ™æ·»åŠ è¿™ä¸ªæ¡ä»¶</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isNotBlank</span><span class="token punctuation">(</span>queryRequest<span class="token punctuation">.</span><span class="token function">getQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// ä½¿ç”¨queryDslï¼ˆå’Œmybatis-plusç±»ä¼¼ï¼‰</span>
            booleanBuilder<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token class-name">QGoods</span>
                    <span class="token punctuation">.</span>goods
                    <span class="token punctuation">.</span>name
                    <span class="token punctuation">.</span><span class="token function">like</span><span class="token punctuation">(</span><span class="token string">&quot;%&quot;</span> <span class="token operator">+</span> queryRequest<span class="token punctuation">.</span><span class="token function">getQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;%&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">// æŸ¥è¯¢</span>
        <span class="token keyword">return</span> goodsRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span>booleanBuilder<span class="token punctuation">,</span> queryRequest<span class="token punctuation">.</span><span class="token function">toPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>application service</p></div><p>å› ä¸ºdomain serviceæ˜¯é¢å‘å®ä½“ç±»ï¼Œè€Œå¤–éƒ¨æŸ¥è¯¢è¯·æ±‚æ˜¯dtoã€‚ä½¿ç”¨éœ€è¦åº”ç”¨å±‚åšç±»å‹è£…æ¢ã€‚é˜²æ­¢domain serviceè¢«å¤–éƒ¨æ±¡æŸ“ã€‚</p><p>æ–°å¢å¦‚ä¸‹å†…å®¹</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Transactional</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GoodsApplicationService</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">GoodsService</span> goodsService<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">PageResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GoodsResponse</span><span class="token punctuation">&gt;</span></span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">QueryRequest</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GoodsQueryRequest</span><span class="token punctuation">&gt;</span></span> queryRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// å°†æŸ¥è¯¢è¯·æ±‚dtoæ˜ å°„ä¸ºentity</span>
        <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Goods</span><span class="token punctuation">&gt;</span></span> queryResult <span class="token operator">=</span> goodsService<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token class-name">GoodsMapper</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">.</span><span class="token function">queryRequest2Entity</span><span class="token punctuation">(</span>queryRequest<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è¿™è¾¹é¦–å…ˆå°†ï¼Œentityæ˜ å°„ä¸ºresponseã€‚å†å°†pageæ˜ å°„ä¸ºPageResultï¼ˆå› ä¸ºpageé‡Œé¢åŒ…å«äº†å¾ˆå¤šæ²¡å¿…è¦çš„ä¿¡æ¯ï¼Œéœ€è¦è¿‡æ»¤æ‰ï¼‰ã€‚</span>
        <span class="token keyword">return</span> <span class="token class-name">PageResult</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>queryResult
                        <span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">GoodsMapper</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token operator">::</span><span class="token function">entity2Response</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                queryResult<span class="token punctuation">.</span><span class="token function">getTotalElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                queryResult<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                queryResult<span class="token punctuation">.</span><span class="token function">getNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>



<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>controller</p></div><p>æ–°å¢æŸ¥è¯¢æ¥å£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;query&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PageResult</span><span class="token punctuation">&lt;</span><span class="token class-name">GoodsResponse</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">QueryRequest</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GoodsQueryRequest</span><span class="token punctuation">&gt;</span></span> queryRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>goodsApplicationService<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>queryRequest<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>æµ‹è¯•</p></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>### æºå¸¦è¿‡æ»¤æ¡ä»¶

POST http://localhost:8080/goods/query
Content-Type: application/json

{
  &quot;page&quot;: 0,
  &quot;pageSize&quot;: 5,
  &quot;query&quot;: {
    &quot;name&quot;: &quot;ç¬”è®°æœ¬&quot;
  }
}
### ä¸æºå¸¦è¿‡æ»¤æ¡ä»¶

POST http://localhost:8080/goods/query
Content-Type: application/json

{
  &quot;page&quot;: 0,
  &quot;pageSize&quot;: 5,
  &quot;query&quot;: {
  }
}
###
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-5-åº“å­˜çš„å¢åŠ å’Œå‡å°‘" tabindex="-1"><a class="header-anchor" href="#_4-5-åº“å­˜çš„å¢åŠ å’Œå‡å°‘" aria-hidden="true">#</a> 4.5 åº“å­˜çš„å¢åŠ å’Œå‡å°‘</h3><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>GoodsStockUpdateRequest</p></div><p>åº“å­˜ä¿®æ”¹dtoï¼Œå…ˆå®šä¹‰ä¿®æ”¹åº“å­˜éœ€è¦å“ªäº›å‚æ•°</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>
<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GoodsStockUpdateRequest</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å•†å“idä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">Long</span> goodsId<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;è´­ä¹°æ•°é‡ä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">Integer</span> count<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>GoodsEntity</p></div><p>æ–°å¢åº“å­˜å±æ€§ä¿®æ”¹çš„æ–¹æ³•ã€‚è¦ä¿®æ”¹entityçš„åº“å­˜åªèƒ½é€šè¿‡è¿™ç§å½¢å¼ï¼Œå› ä¸ºé€šè¿‡entityæä¾›çš„æ–¹æ³•å»ä¿®æ”¹ï¼Œå¯ä»¥å…·æœ‰åˆ¤æ–­é€»è¾‘ã€‚è€Œé€šè¿‡get setçš„å½¢å¼éœ€è¦é¢å¤–å†™if elseåˆ¤æ–­ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">decrease</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    stock <span class="token operator">-=</span> count<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>stock <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BusinessException</span><span class="token punctuation">(</span><span class="token class-name">ResultCode<span class="token punctuation">.</span>UpdateError</span><span class="token punctuation">,</span> <span class="token string">&quot;åº“å­˜ä¸è¶³&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">increase</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    stock <span class="token operator">+=</span> count<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>GoodsService</p></div><p>é¢†åŸŸå±‚serviceæ˜¯ä¸ä¾èµ–å¤–ç•Œçš„dtoï¼Œå®ƒåªåœ¨ä¹è‡ªå·±çš„entityå’Œè‡ªå·±çš„å‚æ•°ã€‚</p><p>å¢åŠ ä¸‹é¢çš„åº“å­˜ä¿®æ”¹æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">decreaseStock</span><span class="token punctuation">(</span><span class="token class-name">Long</span> goodsId<span class="token punctuation">,</span> <span class="token class-name">Integer</span> count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// optionalå‡½æ•°å¼ç¼–ç¨‹</span>
        <span class="token class-name">Goods</span> goods <span class="token operator">=</span> goodsRepository
                <span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>goodsId<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">BusinessException</span><span class="token punctuation">(</span><span class="token class-name">ResultCode<span class="token punctuation">.</span>NotFindError</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods<span class="token punctuation">.</span><span class="token function">decrease</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>goods<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®°å¾—æ¯æ¬¡å¢åŠ ä¿®æ”¹åˆ é™¤éƒ½è¦æ‰“å°æ—¥å¿—</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å•†å“idï¼š{}ï¼Œå‡å°‘åº“å­˜ï¼š{}ï¼Œå‰©ä½™åº“å­˜ï¼š{}&quot;</span><span class="token punctuation">,</span> goodsId<span class="token punctuation">,</span> count<span class="token punctuation">,</span> goods<span class="token punctuation">.</span><span class="token function">getStock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">increaseStock</span><span class="token punctuation">(</span><span class="token class-name">Long</span> goodsId<span class="token punctuation">,</span> <span class="token class-name">Integer</span> count<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Goods</span> goods <span class="token operator">=</span> goodsRepository
                <span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>goodsId<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">BusinessException</span><span class="token punctuation">(</span><span class="token class-name">ResultCode<span class="token punctuation">.</span>NotFindError</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods<span class="token punctuation">.</span><span class="token function">increase</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
        goodsRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>goods<span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å•†å“idï¼š{}ï¼Œå¢åŠ åº“å­˜ï¼š{}ï¼Œå‰©ä½™åº“å­˜ï¼š{}&quot;</span><span class="token punctuation">,</span> goodsId<span class="token punctuation">,</span> count<span class="token punctuation">,</span> goods<span class="token punctuation">.</span><span class="token function">getStock</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>GoodsApplicationService</p></div><p>åº”ç”¨å±‚å°†æ›´æ–°è¯·æ±‚è½¬æˆdomainå±‚éœ€è¦çš„å‚æ•°ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">increaseStock</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GoodsStockUpdateRequest</span><span class="token punctuation">&gt;</span></span> goodsStockUpdateRequests<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    goodsStockUpdateRequests<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>request <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        goodsService<span class="token punctuation">.</span><span class="token function">increaseStock</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getGoodsId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span><span class="token function">getCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">decreaseStock</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GoodsStockUpdateRequest</span><span class="token punctuation">&gt;</span></span> goodsStockUpdateRequests<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    goodsStockUpdateRequests<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>request <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
        goodsService<span class="token punctuation">.</span><span class="token function">decreaseStock</span><span class="token punctuation">(</span>request<span class="token punctuation">.</span><span class="token function">getGoodsId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> request<span class="token punctuation">.</span><span class="token function">getCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>controller</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code>
    <span class="token doc-comment comment">/**
     * ï¼ˆå¯ä»¥æ‰¹é‡å¢åŠ ï¼Œä¹Ÿå¯ä»¥æ‰¹é‡å‡å°‘ï¼‰
     * <span class="token keyword">@param</span> <span class="token parameter">goodsStockUpdateRequests</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;stock/decrease&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">decreaseStock</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token annotation punctuation">@Valid</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GoodsStockUpdateRequest</span><span class="token punctuation">&gt;</span></span> goodsStockUpdateRequests<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        goodsApplicationService<span class="token punctuation">.</span><span class="token function">decreaseStock</span><span class="token punctuation">(</span>goodsStockUpdateRequests<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;stock/increase&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">increaseStock</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GoodsStockUpdateRequest</span><span class="token punctuation">&gt;</span></span> goodsStockUpdateRequests<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        goodsApplicationService<span class="token punctuation">.</span><span class="token function">increaseStock</span><span class="token punctuation">(</span>goodsStockUpdateRequests<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>æµ‹è¯•</p></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>### å¢åŠ 10åº“å­˜
POST http://localhost:8080/goods/stock/increase
Content-Type: application/json

[
  {
    &quot;goodsId&quot;: 46,
    &quot;count&quot;: 10
  }
]


### å‡å°‘20åº“å­˜ï¼ˆå¦‚æœåº“å­˜ä¸è¶³ä¼šæŠ¥é”™ï¼‰


POST http://localhost:8080/goods/stock/decrease
Content-Type: application/json

[
  {
    &quot;goodsId&quot;: 46,
    &quot;count&quot;: 20
  }
]
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-6-openfeignæœåŠ¡è°ƒç”¨" tabindex="-1"><a class="header-anchor" href="#_4-6-openfeignæœåŠ¡è°ƒç”¨" aria-hidden="true">#</a> 4.6 openFeignæœåŠ¡è°ƒç”¨</h3><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>æ ¹pomç®¡ç†ä¾èµ–</p></div><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>${cloud.version}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>apiæ¨¡å—pomä¾èµ–</p></div><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-openfeign<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>C:\Windows\System32\drivers\etc\hosts</p></div><p>åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ è¿™ä¸¤è¡Œdns</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>127.0.0.1 microservice-product
127.0.0.1 microservice-order
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>GoodsFeignClient</p></div><p>å…¶ä»–æ¨¡å—å¼•ç”¨product-apiï¼Œç„¶åè°ƒç”¨<code>GoodsFeignClient</code>å°±å¯ä»¥å‘èµ·httpè¯·æ±‚ï¼Œä¸éœ€è¦åƒæˆ‘ä»¬ä¹‹å‰æµ‹è¯•é‚£æ ·æ‰‹åŠ¨å¡«å†™urlï¼Œå†å‘èµ·è¯·æ±‚ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@FeignClient</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;goods&quot;</span><span class="token punctuation">,</span> url <span class="token operator">=</span> <span class="token string">&quot;http://microservice-product:9000&quot;</span><span class="token punctuation">,</span> path <span class="token operator">=</span> <span class="token string">&quot;goods&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">GoodsFeignClient</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;findAllById&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">GoodsResponse</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">findAllById</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> ids<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;stock/decrease&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">decreaseStock</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GoodsStockUpdateRequest</span><span class="token punctuation">&gt;</span></span> goodsStockUpdateRequests<span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;stock/increase&quot;</span><span class="token punctuation">)</span>
    <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token function">increaseStock</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GoodsStockUpdateRequest</span><span class="token punctuation">&gt;</span></span> goodsStockUpdateRequests<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>è®¢å•æ¨¡å—æ‰«æFeignClient</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token annotation punctuation">@EnableFeignClients</span><span class="token punctuation">(</span>basePackages <span class="token operator">=</span> <span class="token string">&quot;io.qifan.microservice.api&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderApplication</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">OrderApplication</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>æµ‹è¯•</p></div><ol><li>å…ˆè¿è¡ŒProductApplication</li><li>è®¢å•æ¨¡å—å…ˆåˆå§‹åŒ–ä¸€ä¸‹ï¼ˆçœ‹ä»£ç ï¼‰</li><li>åœ¨è®¢å•æ¨¡å—ä¸‹ç¼–å†™å¦‚ä¸‹æµ‹è¯•</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootTest</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GoodsClientTest</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">GoodsFeignClient</span> goodsFeignClient<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     *   å‘èµ·httpè¯·æ±‚å»è®¿é—®å•†å“æ¨¡å—
     *   1. SpringCloudOpenFeignåœ¨å¯åŠ¨æ—¶æ ¹æ®@EnableFeignClients(basePackages = &quot;io.qifan.microservice.api&quot;)
     *   æ‰«æåˆ°@FeignClientï¼Œæ›¿æˆ‘ä»¬ç”Ÿæˆä»£ç†ç±»ã€‚
     *   2. æˆ‘ä»¬è°ƒç”¨ goodsFeignClient.findAllById() è°ƒç”¨ä»£ç†ç±»
     *   3. ä»£ç†ç±»æ ¹æ® @FeignClientä¸Šçš„urlç¡®å®šæœåŠ¡ip+ç«¯å£ã€‚
     *   3.1 å› ä¸ºhttp://microservice-product:9000 è¿™ä¸ªurlé‡Œé¢æ²¡æœ‰ipï¼Œæ‰€ä»¥å‘èµ·è¯·æ±‚æ—¶ä¼šå…ˆä»æœ¬æœºçš„hostsæ‰¾åˆ°æœ‰æ²¡æœ‰
     *   microservice-productå¯¹åº”çš„ipï¼Œæ‰¾åˆ°æœ‰127.0.0.1ï¼Œæ›¿æ¢ç»“æœå˜ä¸º http://127.0.0.1:9000
     *   4. ä»£ç†ç±»æ ¹æ®@GetMappingï¼ˆä¹Ÿå¯ä»¥æ˜¯PostMappingç­‰å…¶ä»–Mappingï¼‰ç¡®å®šè¦è°ƒç”¨å“ªä¸ªè·¯å¾„
     *   5. ä»£ç†ç±»æ ¹æ®@RequestBodyï¼Œ@RequestParamï¼Œ@PathVariableç­‰æ¥ç¡®å®šå‚æ•°æ ¼å¼
     *   6. æœ€åæ‹¼æ¥ä¸Šé¢çš„ä¿¡æ¯å‘èµ·ä¸€ä¸ªhttpè¯·æ±‚ï¼Œå°±åƒæˆ‘ä»¬ä¹‹å‰æµ‹è¯•çš„æ—¶å€™å‘èµ·httpè¯·æ±‚ä¸€æ ·ã€‚
     */</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">GoodsResponse</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> allById <span class="token operator">=</span> goodsFeignClient<span class="token punctuation">.</span><span class="token function">findAllById</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">46L</span><span class="token punctuation">,</span> <span class="token number">49L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        allById<span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>goodsResponse <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>goodsResponse<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-7-å…¨å±€å¼‚å¸¸æ‹¦æˆª" tabindex="-1"><a class="header-anchor" href="#_4-7-å…¨å±€å¼‚å¸¸æ‹¦æˆª" aria-hidden="true">#</a> 4.7 å…¨å±€å¼‚å¸¸æ‹¦æˆª</h3><p>ä¸šåŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­å‡ºç°çš„å¼‚å¸¸ï¼Œåœ¨è¿™è¾¹ç»Ÿä¸€æ‹¦æˆªä¸‹æ¥ï¼Œç„¶åè½¬æˆç»Ÿä¸€çš„è¿”å›ç»“æœï¼Œè¿”å›ç»™å‰ç«¯ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestControllerAdvice</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GlobalExceptionAdvice</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">BusinessException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">R</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">handleBusinessException</span><span class="token punctuation">(</span><span class="token class-name">BusinessException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;ä¸šåŠ¡å¼‚å¸¸&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">BAD_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getResultCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">SystemException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">R</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">handleSystemException</span><span class="token punctuation">(</span><span class="token class-name">SystemException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;ç³»ç»Ÿå¼‚å¸¸&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">BAD_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token class-name">ResultCode<span class="token punctuation">.</span>SystemError</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">R</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">handleException</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;ç³»ç»Ÿå¼‚å¸¸&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">BAD_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token class-name">ResultCode<span class="token punctuation">.</span>SystemError</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">ConstraintViolationException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">R</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">handleValidateException</span><span class="token punctuation">(</span><span class="token class-name">ConstraintViolationException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;æ ¡éªŒå¼‚å¸¸&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä¸åˆæ ¼çš„å­—æ®µï¼Œå¯èƒ½æœ‰å¤šä¸ªï¼Œåªéœ€è¦è¿”å›å…¶ä¸­ä¸€ä¸ªæç¤ºç”¨æˆ·å°±è¡Œ</span>
        <span class="token comment">// æ¯”å¦‚å¯†ç ä¸ºç©º</span>
        <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">ConstraintViolation</span><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> constraintViolations <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getConstraintViolations</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">BAD_REQUEST</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token class-name">ResultCode<span class="token punctuation">.</span>ValidateError</span><span class="token punctuation">,</span> constraintViolations<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">MethodArgumentNotValidException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">R</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">handleValidateException</span><span class="token punctuation">(</span><span class="token class-name">MethodArgumentNotValidException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;æ ¡éªŒå¼‚å¸¸&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä¸åˆæ ¼çš„å­—æ®µï¼Œå¯èƒ½æœ‰å¤šä¸ªï¼Œåªéœ€è¦è¿”å›å…¶ä¸­ä¸€ä¸ªæç¤ºç”¨æˆ·å°±è¡Œ</span>
        <span class="token comment">// æ¯”å¦‚å¯†ç ä¸ºç©º</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">FieldError</span><span class="token punctuation">&gt;</span></span> fieldErrors <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">getFieldErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">FieldError</span> fieldError <span class="token operator">=</span> fieldErrors<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">ResponseEntity</span><span class="token punctuation">.</span><span class="token function">status</span><span class="token punctuation">(</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span><span class="token constant">BAD_REQUEST</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">body</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">fail</span><span class="token punctuation">(</span><span class="token class-name">ResultCode<span class="token punctuation">.</span>ValidateError</span><span class="token punctuation">,</span> fieldError<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_5-è®¢å•æ¨¡å—" tabindex="-1"><a class="header-anchor" href="#_5-è®¢å•æ¨¡å—" aria-hidden="true">#</a> 5. è®¢å•æ¨¡å—</h2><h3 id="_5-1-è®¢å•é¢†åŸŸå±‚" tabindex="-1"><a class="header-anchor" href="#_5-1-è®¢å•é¢†åŸŸå±‚" aria-hidden="true">#</a> 5.1 è®¢å•é¢†åŸŸå±‚</h3><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>çŸ¥è¯†æ¦‚è§ˆ</p></div><ol><li>èšåˆæ ¹ï¼ˆ<code>Aggregates</code>ï¼‰</li><li>ä½¿ç”¨<code>Converter</code>åœ¨javaå’Œæ•°æ®åº“ä¹‹é—´è½¬æ¢ç±»å‹ã€‚</li><li>jpa joinæŸ¥è¯¢</li><li>ä½¿ç”¨å€¼å¯¹è±¡ï¼ˆ<code>Value Object</code>ï¼‰æ¥æ˜ç¡®å­—æ®µè¯­ä¹‰å’Œæ•°æ®æ ¡éªŒ</li></ol><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>è®¢å•é¡¹</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;base_order_item&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Entity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BaseOrderItem</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å•†å“idä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> goodsId<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;æ•°é‡ä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> count<span class="token punctuation">;</span>

 
    <span class="token comment">// å•†å“æ˜¯javaå¯¹è±¡ï¼Œåœ¨æ•°æ®åº“æ˜¯jsonç±»å‹ï¼Œæ’å…¥åˆ°æ•°æ®åº“æ—¶éœ€è¦è½¬æ¢ä¸€ä¸‹ã€‚</span>
    <span class="token annotation punctuation">@Convert</span><span class="token punctuation">(</span>converter <span class="token operator">=</span> <span class="token class-name">ProductConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>columnDefinition <span class="token operator">=</span> <span class="token string">&quot;json&quot;</span><span class="token punctuation">,</span> nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">GoodsResponse</span> goods<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>è®¢å•èšåˆæ ¹</p></div><p>å®é™…çš„ä¸šåŠ¡ä¸­ï¼Œä¸€ä¸ªè®¢å•åŒ…å«å¤šä¸ªè®¢å•é¡¹ï¼ˆ1å¯¹å¤šï¼‰ã€‚æ‰€ä»¥<code>OrderItem</code>é€šè¿‡å¤–é”®å…³è”<code>BaseOrder</code>ã€‚åŒæ—¶ä¸€ä¸ªè®¢å•è¿˜ä¼šå…³è”ç”¨æˆ·ï¼Œä¼˜æƒ åˆ¸ç­‰ä¿¡æ¯ï¼Œæœ¬æ¡ˆä¾‹æ²¡ä½“ç°ã€‚</p><p>è¿™ç§å®ä½“ç±»å°±æ˜¯èšåˆæ ¹äº†ã€‚å®ƒå…³è”äº†è®¸å¤šç›¸å…³å®ä½“ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Entity</span>
<span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;base_order&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@Setter</span>
<span class="token annotation punctuation">@ToString</span><span class="token punctuation">(</span>callSuper <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BaseOrder</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;è®¢å•é‡‘é¢ä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>precision <span class="token operator">=</span> <span class="token number">12</span><span class="token punctuation">,</span> scale <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">BigDecimal</span> totalAmount<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;è´¦æˆ·idä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> accountId<span class="token punctuation">;</span>

    <span class="token comment">// æ’å…¥è®¢å•ä¹Ÿä¼šåŒæ—¶æ’å…¥è®¢å•é¡¹ï¼ŒæŸ¥è¯¢è®¢å•æ—¶ä¹Ÿä¼šè‡ªåŠ¨joinæŸ¥å‡ºè®¢å•é¡¹ã€‚</span>
    <span class="token annotation punctuation">@OneToMany</span><span class="token punctuation">(</span>fetch <span class="token operator">=</span> <span class="token class-name">FetchType</span><span class="token punctuation">.</span><span class="token constant">EAGER</span><span class="token punctuation">,</span> cascade <span class="token operator">=</span> <span class="token class-name">CascadeType</span><span class="token punctuation">.</span><span class="token constant">ALL</span><span class="token punctuation">)</span>
    <span class="token comment">// åœ¨è®¢å•é¡¹è¡¨ç”Ÿæˆå¤–é”®base_order_idï¼Œå…³è”æœ¬è¡¨çš„ä¸»é”®ã€‚</span>
    <span class="token comment">// è®¢å•é¡¹å®ä½“ç±»ä¸éœ€è¦base_order_idè¿™ä¸ªå­—æ®µï¼Œè¿™è¾¹ä¼šè‡ªåŠ¨ç”Ÿæˆè¿™ä¸ªå­—æ®µã€‚</span>
    <span class="token annotation punctuation">@JoinColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;base_order_id&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Size</span><span class="token punctuation">(</span>min <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">&quot;è´­ä¹°å•†å“ä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BaseOrderItem</span><span class="token punctuation">&gt;</span></span> itemList<span class="token punctuation">;</span>

    <span class="token comment">// è®¢å•çŠ¶æ€æ˜¯javaæšä¸¾ç±»å‹ï¼Œåœ¨æ•°æ®åº“æ˜¯intç±»å‹ï¼Œæ’å…¥åˆ°æ•°æ®åº“æ—¶éœ€è¦è½¬æ¢ä¸€ä¸‹ã€‚</span>
    <span class="token annotation punctuation">@Convert</span><span class="token punctuation">(</span>converter <span class="token operator">=</span> <span class="token class-name">OrderStateConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@NotNull</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;è®¢å•çŠ¶æ€ä¸èƒ½ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">OrderState</span> orderState<span class="token punctuation">;</span>

    <span class="token comment">// åˆ›å»ºæ—¶çš„åˆå§‹åŒ–æ“ä½œç”±å®ä½“ç±»æœ¬èº«å»æ“ä½œï¼Œä¸éœ€è¦å¤–éƒ¨å»set</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        totalAmount <span class="token operator">=</span> <span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token constant">ZERO</span><span class="token punctuation">;</span>
        orderState <span class="token operator">=</span> <span class="token class-name">OrderState</span><span class="token punctuation">.</span><span class="token constant">UNPAID</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>è®¢å•çŠ¶æ€å€¼å¯¹è±¡</p></div><p>æƒ³è±¡ä¸€ä¸‹å¦‚æœæˆ‘ä»¬ä¸ç”¨å€¼å¯¹è±¡æ¥æ ‡è¯†è®¢å•çŠ¶æ€ï¼Œå•å•ä¸€ä¸ª<code>Integer</code>ç±»å‹æ¥æ ‡è¯†ã€‚<br> æœ‰å¦‚ä¸‹ç¼ºç‚¹ï¼š</p><ol><li>è¯­ä¹‰ä¸æ¸…æ™°ï¼Œé™¤äº†å¼€å‘è¿™ä¸ªåŠŸèƒ½çš„äººï¼Œå…¶ä»–äººéƒ½éš¾ä»¥æ˜ç™½æ¯ä¸ªå€¼çš„å«æœ‰ï¼Œä»¥åŠæœ‰å¤šå°‘å–å€¼ã€‚ç”šè‡³å¼€å‘è€…åˆ°åé¢è‡ªå·±éƒ½æ™•äº†ï¼ˆæ²¡é”™å°±æ˜¯æˆ‘äº†T_Tï¼‰</li><li>éœ€è¦é¢å¤–çš„æ ¡éªŒé€»è¾‘ï¼Œæ•´æ•°çš„å–å€¼å¾ˆå¤§ï¼Œéœ€è¦åˆ¤æ–­æ•´æ•°å–å€¼æ˜¯å¦è¶…å‡ºäº†èŒƒå›´ã€‚</li></ol><p>ä½¿ç”¨å€¼å¯¹è±¡è™½ç„¶æ²¡æœ‰ä¸Šé¢çš„ç¼ºç‚¹ï¼Œä½†æ˜¯å®ƒä¹Ÿæœ‰è‡ªå·±çš„çš„ç¼ºç‚¹<br> å¦‚ä¸‹ï¼š</p><ol><li>éœ€è¦ç¼–å†™è½¬æ¢å™¨æ¥åœ¨æ•°æ®åº“å’Œdtoä¹‹é—´è½¬æ¢ï¼Œå·¥ä½œé‡æå‡ã€‚</li></ol><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">OrderState</span> <span class="token keyword">implements</span> <span class="token class-name">BaseEnum</span> <span class="token punctuation">{</span>
    <span class="token function">UNPAID</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token string">&quot;å¾…æ”¯ä»˜&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">PAID</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;å·²æ”¯ä»˜&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">CANCELED</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;å·²å–æ¶ˆ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token keyword">final</span> <span class="token class-name">Integer</span> code<span class="token punctuation">;</span>

    <span class="token keyword">final</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> code<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// æ ¹æ®codeæ‰¾åˆ°æšä¸¾å¯¹è±¡</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OrderState</span><span class="token punctuation">&gt;</span></span> <span class="token function">of</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> code<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token class-name">OrderState</span><span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>resultCode <span class="token operator">-&gt;</span> resultCode<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">findFirst</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>Converter è½¬æ¢å™¨</p></div><p>å½“å®ä½“ç±»ä¸­å­˜åœ¨è‡ªå®šä¹‰çš„javaå¯¹è±¡æ—¶ï¼Œæ— æ³•ç›´æ¥ä¿å­˜åˆ°æ•°æ®åº“ã€‚è¿™æ—¶éœ€è¦ç¼–å†™è½¬æ¢å™¨ã€‚</p><p>Converterä¸Mapperç±»ä¼¼ï¼Œä¸€ä¸ªè§£å†³çš„æ˜¯entityä¸æ•°æ®åº“çš„å­—æ®µæ˜ å°„ï¼Œä¸€ä¸ªè§£å†³çš„æ˜¯entityä¸dtoçš„å­—æ®µæ˜ å°„ã€‚</p><p><strong>è®¢å•çŠ¶æ€è½¬æ¢å™¨</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Converter</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderStateConverter</span> <span class="token keyword">implements</span> <span class="token class-name">AttributeConverter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">OrderState</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * è¿™ä¸ªæ˜ å°„åœ¨ å®ä½“ç±» -&gt; æ•°æ®åº“å’Œå®ä½“ç±» -&gt; Responseæ—¶éƒ½å¯ä»¥ç”¨ã€‚
     * è®¢å•çŠ¶æ€æšä¸¾ç±»å‹-&gt; æ•´æ•°ç±»å‹
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">Integer</span> <span class="token function">convertToDatabaseColumn</span><span class="token punctuation">(</span><span class="token class-name">OrderState</span> orderState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> orderState<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token doc-comment comment">/**
     * è¿™ä¸ªæ˜ å°„åœ¨ æ•°æ®åº“ -&gt; å®ä½“ç±»å’ŒRequest -&gt; å®ä½“ç±»æ—¶éƒ½å¯ä»¥ç”¨ã€‚
     * æ•´æ•°ç±»å‹ -&gt; è®¢å•çŠ¶æ€æšä¸¾ç±»å‹
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">OrderState</span> <span class="token function">convertToEntityAttribute</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> integer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">OrderState</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>integer<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">orElseThrow</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-&gt;</span><span class="token keyword">new</span> <span class="token class-name">SystemException</span><span class="token punctuation">(</span><span class="token string">&quot;è®¢å•çŠ¶æ€ååºåˆ—åŒ–å¼‚å¸¸&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å•†å“è½¬æ¢å™¨</strong></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Converter</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProductConverter</span> <span class="token keyword">implements</span> <span class="token class-name">AttributeConverter</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GoodsResponse</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * æ•°æ®åº“é‡Œé¢productè¿™ä¸ªå­—æ®µæ˜¯stringç±»å‹ï¼Œè€Œjavaé‡Œé¢è¿™ä¸ªå­—æ®µæ˜¯GoodsResponse
     * GoodsResponseåºåˆ—åŒ–æˆjsonå­—ç¬¦ä¸²
     *
     * <span class="token keyword">@param</span> <span class="token parameter">attribute</span> å®ä½“ç±»éœ€è¦è½¬æ¢çš„å­—æ®µ
     * <span class="token keyword">@return</span> jsonå­—ç¬¦ä¸²
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">convertToDatabaseColumn</span><span class="token punctuation">(</span><span class="token class-name">GoodsResponse</span> attribute<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token class-name">JacksonObject</span><span class="token punctuation">.</span>objectMapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>attribute<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JsonProcessingException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BusinessException</span><span class="token punctuation">(</span><span class="token class-name">ResultCode<span class="token punctuation">.</span>SystemError</span><span class="token punctuation">,</span> <span class="token string">&quot;å•†å“è¯¦æƒ…è½¬jsonå¼‚å¸¸&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * æ•°æ®åº“é‡Œé¢productè¿™ä¸ªå­—æ®µæ˜¯stringç±»å‹ï¼Œè€Œjavaé‡Œé¢è¿™ä¸ªå­—æ®µæ˜¯GoodsResponse
     * jsonå­—ç¬¦ä¸²ååºåˆ—åŒ–æˆGoodsResponse
     *
     * <span class="token keyword">@param</span> <span class="token parameter">dbData</span> æ•°æ®åº“é‡Œé¢çš„jsonå­—ç¬¦ä¸²
     * <span class="token keyword">@return</span> GoodsResponseå¯¹è±¡
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">GoodsResponse</span> <span class="token function">convertToEntityAttribute</span><span class="token punctuation">(</span><span class="token class-name">String</span> dbData<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token class-name">JacksonObject</span><span class="token punctuation">.</span>objectMapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span>dbData<span class="token punctuation">,</span> <span class="token class-name">GoodsResponse</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">JsonProcessingException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BusinessException</span><span class="token punctuation">(</span><span class="token class-name">ResultCode<span class="token punctuation">.</span>SystemError</span><span class="token punctuation">,</span> <span class="token string">&quot;jsonè½¬å•†å“è¯¦æƒ…å¼‚å¸¸&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>OrderRepository</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BaseOrderRepository</span> <span class="token keyword">extends</span> <span class="token class-name">BaseRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BaseOrder</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>æµ‹è¯•</p></div><p>åœºæ™¯ï¼šå°æ˜æäº¤äº†ä¸€ä¸ªè®¢å•ï¼Œè®¢å•é‡Œé¢ç”±ä¸¤ä¸ªå•†å“ã€‚å°æ˜ä¹Ÿå¯ä»¥æŸ¥çœ‹è‡ªå·±çš„è®¢å•ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@SpringBootTest</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderTest</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">BaseOrderRepository</span> baseOrderRepository<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">GoodsFeignClient</span> goodsFeignClient<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">saveTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">GoodsResponse</span> goods1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GoodsResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods1<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">40L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods1<span class="token punctuation">.</span><span class="token function">setCover</span><span class="token punctuation">(</span><span class="token string">&quot;http://xxxx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods1<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;ç¬”è®°æœ¬&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods1<span class="token punctuation">.</span><span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">4000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods1<span class="token punctuation">.</span><span class="token function">setStock</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">GoodsResponse</span> goods2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GoodsResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods2<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">41L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods2<span class="token punctuation">.</span><span class="token function">setCover</span><span class="token punctuation">(</span><span class="token string">&quot;http://xxxx&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods2<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;é¼ æ ‡&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods2<span class="token punctuation">.</span><span class="token function">setPrice</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        goods2<span class="token punctuation">.</span><span class="token function">setStock</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è´­ä¹°äº†ä¸€å°ç¬”è®°æœ¬</span>
        <span class="token class-name">BaseOrderItem</span> baseOrderItem1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BaseOrderItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        baseOrderItem1<span class="token punctuation">.</span><span class="token function">setGoods</span><span class="token punctuation">(</span>goods1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        baseOrderItem1<span class="token punctuation">.</span><span class="token function">setCount</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        baseOrderItem1<span class="token punctuation">.</span><span class="token function">setGoodsId</span><span class="token punctuation">(</span>goods1<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è´­ä¹°äº†ä¸¤ä¸ªé¼ æ ‡</span>
        <span class="token class-name">BaseOrderItem</span> baseOrderItem2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BaseOrderItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        baseOrderItem2<span class="token punctuation">.</span><span class="token function">setGoods</span><span class="token punctuation">(</span>goods2<span class="token punctuation">)</span><span class="token punctuation">;</span>
        baseOrderItem2<span class="token punctuation">.</span><span class="token function">setCount</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        baseOrderItem2<span class="token punctuation">.</span><span class="token function">setGoodsId</span><span class="token punctuation">(</span>goods2<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// è®¢å•å…³è”ä¸¤ä¸ªè®¢å•é¡¹</span>
        <span class="token class-name">BaseOrder</span> baseOrder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BaseOrder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// åˆå§‹åŒ–æ“ä½œ</span>
        baseOrder<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        baseOrder<span class="token punctuation">.</span><span class="token function">setAccountId</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        baseOrder<span class="token punctuation">.</span><span class="token function">setTotalAmount</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token number">4200</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        baseOrder<span class="token punctuation">.</span><span class="token function">setItemList</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>baseOrderItem1<span class="token punctuation">,</span> baseOrderItem2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        baseOrderRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>baseOrder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;è®¢å•ï¼š{}ï¼Œåˆ›å»ºæˆåŠŸ&quot;</span><span class="token punctuation">,</span> baseOrder<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">findTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// æŸ¥è¯¢å°æ˜çš„è®¢å•</span>
        baseOrderRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token class-name">QBaseOrder</span><span class="token punctuation">.</span>baseOrder<span class="token punctuation">.</span>accountId<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token number">1L</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span>baseOrder <span class="token operator">-&gt;</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>baseOrder<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_5-2-è®¢å•åˆ›å»º" tabindex="-1"><a class="header-anchor" href="#_5-2-è®¢å•åˆ›å»º" aria-hidden="true">#</a> 5.2 è®¢å•åˆ›å»º</h3><p>ä¸ŠèŠ‚çš„è®¢å•åˆ›å»ºæ¡ˆä¾‹æ¯”è¾ƒç®€å•ï¼Œæ²¡æœ‰å•†å“æŸ¥è¯¢å’Œä»·æ ¼æ ¸ç®—ï¼Œä¹Ÿä¸æ˜¯httpè¯·æ±‚ã€‚</p><p>è¿™èŠ‚æˆ‘ä»¬é€šè¿‡httpå‘èµ·è¯·æ±‚æ¥åˆ›å»ºä¸€ä¸ªè®¢å•</p><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>è®¢å•é¡¹mapper</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BaseOrderItemMapper</span> <span class="token punctuation">{</span>
  <span class="token class-name">BaseOrderItemMapper</span> <span class="token constant">INSTANCE</span> <span class="token operator">=</span> <span class="token class-name">Mappers</span><span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">BaseOrderItemMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token class-name">BaseOrderItem</span> <span class="token function">createRequest2Entity</span><span class="token punctuation">(</span><span class="token class-name">BaseOrderItemCreateRequest</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token class-name">BaseOrderItemResponse</span> <span class="token function">entity2Response</span><span class="token punctuation">(</span><span class="token class-name">BaseOrderItem</span> entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>åŸºç¡€è®¢å•mapper</p></div><p>å¯ä»¥çœ‹è§ï¼ŒåŸºç¡€è®¢å•mapperä½¿ç”¨äº†è®¢å•é¡¹mapperã€‚å› ä¸º<code>BaseOrder</code>å®ä½“ç±»çš„<code>itemList</code>å­—æ®µç±»å‹æ˜¯<code>List&lt;BaseOrderItem&gt;</code>ï¼Œè€Œ<code>BaseOrderCreateRequest</code>çš„<code>itemList</code>å­—æ®µç±»å‹æ˜¯<code> List&lt;BaseOrderItemCreateRequest&gt;</code>ã€‚</p><p><code>BaseOrderItemCreateRequest</code>-&gt; <code>BaseOrderItem</code>çš„æ˜ å°„<code>BaseOrderItemMapper</code>é‡Œé¢å·²ç»æœ‰äº†ï¼Œæ‰€ä»¥ç›´æ¥ä½¿ç”¨å°±è¡Œã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Mapper</span><span class="token punctuation">(</span>
        <span class="token keyword">uses</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token class-name">BaseOrderItemMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token class-name">OrderStateConverter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">}</span>
<span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">BaseOrderMapper</span> <span class="token punctuation">{</span>
    <span class="token class-name">BaseOrderMapper</span> <span class="token constant">INSTANCE</span> <span class="token operator">=</span> <span class="token class-name">Mappers</span><span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">BaseOrderMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">BaseOrder</span> <span class="token function">createRequest2Entity</span><span class="token punctuation">(</span><span class="token class-name">BaseOrderCreateRequest</span> request<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token class-name">BaseOrderResponse</span> <span class="token function">entity2Response</span><span class="token punctuation">(</span><span class="token class-name">BaseOrder</span> entity<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>è®¢å•åº”ç”¨å±‚service</p></div><p>åº”ç”¨å±‚çš„è®¢å•åˆ›å»ºä¸»è¦æ˜¯æµç¨‹ç¼–æ’ã€‚å¯ä»¥çœ‹è§ä¸‹é¢çš„createæ–¹æ³•ä¸åŒ…å«ä»»ä½•é€»è¾‘ï¼Œå°±æ˜¯æŒ‰æµç¨‹æ¥åˆ›å»ºè®¢å•ã€‚</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Transactional</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderApplicationService</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">BaseOrderService</span> baseOrderService<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">BaseOrderRepository</span> baseOrderRepository<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">BaseOrderCreateRequest</span> createRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BaseOrder</span> baseOrder <span class="token operator">=</span> <span class="token class-name">BaseOrderMapper</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token punctuation">.</span><span class="token function">createRequest2Entity</span><span class="token punctuation">(</span>createRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®¢å•åˆå§‹è¯æ“ä½œ</span>
        baseOrder<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// ä»·æ ¼è®¡ç®—ï¼Œæ‰£å‡åº“å­˜</span>
        baseOrderService<span class="token punctuation">.</span><span class="token function">computePrice</span><span class="token punctuation">(</span>baseOrder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// æ’å…¥è®¢å•åˆ°æ•°æ®åº“ï¼ŒåŒæ—¶æ’å…¥è®¢å•é¡¹åˆ°æ•°æ®åº“</span>
        baseOrderRepository<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>baseOrder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;åˆ›å»ºè®¢å•ï¼š{}&quot;</span><span class="token punctuation">,</span> baseOrder<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> baseOrder<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>é¢†åŸŸå±‚è®¢å•service</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Service</span>
<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BaseOrderService</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">GoodsFeignClient</span> goodsFeignClient<span class="token punctuation">;</span>


    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">computePrice</span><span class="token punctuation">(</span><span class="token class-name">BaseOrder</span> baseOrder<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> goodsIds <span class="token operator">=</span> baseOrder
                <span class="token punctuation">.</span><span class="token function">getItemList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">BaseOrderItem</span><span class="token operator">::</span><span class="token function">getGoodsId</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è°ƒç”¨å•†å“æœåŠ¡æŸ¥è¯¢ä¿¡æ¯</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GoodsResponse</span><span class="token punctuation">&gt;</span></span> result <span class="token operator">=</span> goodsFeignClient<span class="token punctuation">.</span><span class="token function">findAllById</span><span class="token punctuation">(</span>goodsIds<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®¡ç®—ä»·æ ¼</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> result<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">GoodsResponse</span> goods <span class="token operator">=</span> result<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">BaseOrderItem</span> baseOrderItem <span class="token operator">=</span> baseOrder<span class="token punctuation">.</span><span class="token function">getItemList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// è®¾ç½®å•†å“è¯¦æƒ…</span>
            baseOrderItem<span class="token punctuation">.</span><span class="token function">setGoods</span><span class="token punctuation">(</span>goods<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// è®¡ç®—ä»·æ ¼</span>
            <span class="token comment">// å•†å“å•ä»·*æ•°é‡</span>
            <span class="token class-name">BigDecimal</span> itemPrice <span class="token operator">=</span> goods<span class="token punctuation">.</span><span class="token function">getPrice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">multiply</span><span class="token punctuation">(</span><span class="token class-name">BigDecimal</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>baseOrderItem<span class="token punctuation">.</span><span class="token function">getCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// ç´¯åŠ </span>
            baseOrder<span class="token punctuation">.</span><span class="token function">setTotalAmount</span><span class="token punctuation">(</span>baseOrder<span class="token punctuation">.</span><span class="token function">getTotalAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>itemPrice<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æ€»ä»·æ ¼ï¼š{}&quot;</span><span class="token punctuation">,</span> baseOrder<span class="token punctuation">.</span><span class="token function">getTotalAmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">GoodsStockUpdateRequest</span><span class="token punctuation">&gt;</span></span> goodsStockUpdateRequests <span class="token operator">=</span> baseOrder<span class="token punctuation">.</span><span class="token function">getItemList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">// å¾—åˆ°è¦æ‰£å‡çš„å•†å“idå’Œæ‰£é™¤æ•°é‡</span>
                <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>item <span class="token operator">-&gt;</span> <span class="token keyword">new</span> <span class="token class-name">GoodsStockUpdateRequest</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span><span class="token function">getGoodsId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> item<span class="token punctuation">.</span><span class="token function">getCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è°ƒç”¨å•†å“æœåŠ¡æ‰£å‡åº“å­˜</span>
        goodsFeignClient<span class="token punctuation">.</span><span class="token function">decreaseStock</span><span class="token punctuation">(</span>goodsStockUpdateRequests<span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;è®¡ç®—ä»·æ ¼ï¼Œå¹¶æ‰£å‡åº“å­˜ã€‚å•†å“è´­ä¹°è¯¦æƒ…ï¼š{}&quot;</span><span class="token punctuation">,</span> baseOrder<span class="token punctuation">.</span><span class="token function">getItemList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>controller</p></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;order&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@RequiredArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OrderController</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">OrderApplicationService</span> orderApplicationService<span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">BaseOrderRepository</span> baseOrderRepository<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;create&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Long</span><span class="token punctuation">&gt;</span></span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">BaseOrderCreateRequest</span> createRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>orderApplicationService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createRequest<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;query&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">R</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">PageResult</span><span class="token punctuation">&lt;</span><span class="token class-name">BaseOrderResponse</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">query</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">QueryRequest</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BaseOrderQueryRequest</span><span class="token punctuation">&gt;</span></span> queryRequest<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">BooleanBuilder</span> booleanBuilder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BooleanBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>queryRequest<span class="token punctuation">.</span><span class="token function">getQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAccountId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            booleanBuilder<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token class-name">QBaseOrder</span><span class="token punctuation">.</span>baseOrder<span class="token punctuation">.</span>accountId<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span>queryRequest<span class="token punctuation">.</span><span class="token function">getQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getAccountId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>queryRequest<span class="token punctuation">.</span><span class="token function">getQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getOrderState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            booleanBuilder<span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token class-name">QBaseOrder</span><span class="token punctuation">.</span>baseOrder<span class="token punctuation">.</span>orderState<span class="token punctuation">.</span><span class="token function">eq</span><span class="token punctuation">(</span><span class="token class-name">OrderState</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>queryRequest<span class="token punctuation">.</span><span class="token function">getQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getOrderState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span>
        <span class="token class-name">Page</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">BaseOrder</span><span class="token punctuation">&gt;</span></span> all <span class="token operator">=</span> baseOrderRepository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span>booleanBuilder<span class="token punctuation">,</span> queryRequest<span class="token punctuation">.</span><span class="token function">toPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">R</span><span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span><span class="token class-name">PageResult</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>all
                        <span class="token punctuation">.</span><span class="token function">getContent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">stream</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token class-name">BaseOrderMapper</span><span class="token punctuation">.</span><span class="token constant">INSTANCE</span><span class="token operator">::</span><span class="token function">entity2Response</span><span class="token punctuation">)</span>
                        <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                all<span class="token punctuation">.</span><span class="token function">getTotalElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                all<span class="token punctuation">.</span><span class="token function">getSize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                all<span class="token punctuation">.</span><span class="token function">getNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>æµ‹è¯•</p></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>### åˆ›å»ºè®¢å•
POST http://localhost:9001/order/create
Content-Type: application/json

{
  &quot;accountId&quot;: 1,
  &quot;itemList&quot;: [
    {
      &quot;goodsId&quot;: 48,
      &quot;count&quot;: 2
    },
    {
      &quot;goodsId&quot;: 49,
      &quot;count&quot;: 1
    }
  ]
}

### æŸ¥è¯¢è®¢å•

POST http://localhost:9001/order/query
Content-Type: application/json

{
  &quot;page&quot;: 0,
  &quot;pageSize&quot;: 5,
  &quot;query&quot;: {
    &quot;accountId&quot;: 1,
    &quot;orderState&quot;: 0
  }
}
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_6-å…­è¾¹å½¢æ¶æ„" tabindex="-1"><a class="header-anchor" href="#_6-å…­è¾¹å½¢æ¶æ„" aria-hidden="true">#</a> 6. å…­è¾¹å½¢æ¶æ„</h2><figure><img src="/blog/assets/gPKrg-2cd28eb1.jpg" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="_6-1-é¢†åŸŸå±‚-domain" tabindex="-1"><a class="header-anchor" href="#_6-1-é¢†åŸŸå±‚-domain" aria-hidden="true">#</a> 6.1 é¢†åŸŸå±‚ï¼ˆ<code>domain</code>ï¼‰</h3><p>é¢†åŸŸå±‚æ˜¯çœŸæ­£çš„é€»è¾‘å®ç°å±‚ï¼Œå°†ä¸€ä¸ªå¤æ‚é€»è¾‘æ‰“ç¢å±‚ä¸€ä¸ªä¸ªdomianã€‚å†é€šè¿‡åº”ç”¨å±‚å°†ä¸€ä¸ªä¸ªå•ä¸€é€»è¾‘é¢†åŸŸç¼–æ’ç»„åˆæˆä¸€ä¸ªåº”ç”¨æ¥æä¾›æœåŠ¡ã€‚</p><ol><li>åŸºæœ¬çš„å®ä½“ç±»ï¼ˆ<code>Entity</code>ï¼‰å’Œæ•°æ®åº“ç›¸å¯¹åº”</li><li>å®ä½“ç±»é‡Œé¢çš„å¤æ‚å±æ€§åˆå¯ä»¥æŠ½è±¡å‡ºå€¼å¯¹è±¡ï¼ˆ<code>Value Object</code>ï¼‰</li><li>èšåˆæ ¹ï¼ˆ<code>Aggregates</code>ï¼‰ï¼Œåœ¨å®é™…ä¸šåŠ¡ä¸­ï¼Œæœ‰äº›è¡¨å¾€å¾€ç®¡ç†è®¸å¤šå­è¡¨ã€‚é‚£è¿™ç§å®ä½“å°±æ˜¯èšåˆæ ¹ã€‚æˆ‘ä»¬å¸Œæœ›æŸ¥èšåˆæ ¹æ—¶å¯ä»¥ç›´æ¥æŸ¥å‡ºç›¸å…³å¯¹è±¡ï¼Œæ’å…¥èšåˆæ ¹æ—¶èƒ½åŒæ—¶åœ¨å­è¡¨æ’å…¥æ•°æ®ã€‚èšåˆæ ¹æé«˜æˆ‘ä»¬çš„é€»è¾‘å†…èšã€‚</li><li>é¢†åŸŸäº‹ä»¶ï¼ˆ<code>Domain Event</code>ï¼‰ã€‚å½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªè®¢å•æ—¶ï¼Œæˆ‘ä»¬å¯èƒ½è¿˜éœ€è¦åšä¸€äº›åç»­ä»æ“ä½œï¼Œè¿™äº›æ“ä½œå…·æœ‰æ‹“å±•æ€§ï¼Œç”šè‡³è¿™äº›æ“ä½œä¸åœ¨æœ¬æœåŠ¡ã€‚è¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°é¢†åŸŸäº‹ä»¶ï¼ˆè§‚å¯Ÿè€…æ¨¡å¼ï¼‰ï¼Œæ¥åšé€»è¾‘ä¸Šçš„è§£è€¦ã€‚</li><li>é¢†åŸŸæœåŠ¡ï¼ˆ<code>Domain Service</code>ï¼‰ã€‚é¢†åŸŸæœåŠ¡åªä¸“æ³¨ä¸å®ä½“ç±»ä¸Šçš„å•ä¸€é€»è¾‘ï¼Œè¿™ä¸ªé€»è¾‘å¯èƒ½ä¼šæ¶‰åŠåˆ°å‡ ä¸ªç›¸å…³çš„å®ä½“ç±»ã€‚åƒåˆ›å»ºä¸€ä¸ªèšåˆæ ¹æ—¶ï¼Œå¾€å¾€éœ€è¦åŒæ—¶åˆ›å»ºå…¶ä»–çš„å®ä½“ã€‚</li></ol><h3 id="_6-2-åº”ç”¨å±‚-application" tabindex="-1"><a class="header-anchor" href="#_6-2-åº”ç”¨å±‚-application" aria-hidden="true">#</a> 6.2 åº”ç”¨å±‚ï¼ˆ<code>Application</code>ï¼‰</h3><p>åº”ç”¨å±‚åˆç§°ç”¨ä¾‹ï¼Œç”¨ä¾‹æ˜¯å¤–éƒ¨æœ€å…³ç³»çš„æ¦‚å¿µï¼Œå› ä¸ºå®ƒæ„å‘³ç€åŠŸèƒ½ã€‚æ‰€ä»¥åº”ç”¨å±‚çš„ä½œç”¨æ˜¯å°†å¤šä¸ªé€»è¾‘ç»„åˆæˆä¸€ä¸ªç”¨ä¾‹ä¸å¤–éƒ¨äº¤äº’ã€‚æ‰€ä»¥æ€»çš„æ¥è¯´åº”ç”¨å±‚æ˜¯èµ°ä¸€ä¸ªé€»è¾‘çš„æµç¨‹ï¼Œè€Œä¸å»å®ç°é€»è¾‘ã€‚</p><ol><li>å¤„ç†controolerè°ƒç”¨ï¼Œåšç±»å‹è½¬æ¢ï¼Œå°†dtoè½¬æˆentityï¼Œè®©<code>domain service</code>å»å®ç°é€»è¾‘ã€‚</li><li>å¤„ç†å¤æ‚é€»è¾‘æ—¶ï¼Œç»„åˆå¤šä¸ª<code>domain service</code>å»å®ç°ã€‚</li><li>ä¸ä¾èµ–å…¶ä»–<code>application service</code></li></ol><h3 id="_6-3-åŸºç¡€è®¾æ–½å±‚-infrastructure" tabindex="-1"><a class="header-anchor" href="#_6-3-åŸºç¡€è®¾æ–½å±‚-infrastructure" aria-hidden="true">#</a> 6.3 åŸºç¡€è®¾æ–½å±‚ï¼ˆ<code>Infrastructure</code>ï¼‰</h3><p>åœ†åœˆå¤–å›´çš„å³åŠéƒ¨åˆ†ã€‚</p><p>åŸºç¡€è®¾æ–½å±‚ä¸€èˆ¬å°±æ˜¯é…ç½®ï¼Œä¸­é—´ä»¶çš„å®ç°ç­‰ã€‚</p><h3 id="_6-4-ç«¯å£-port" tabindex="-1"><a class="header-anchor" href="#_6-4-ç«¯å£-port" aria-hidden="true">#</a> 6.4 ç«¯å£ï¼ˆ<code>Port</code>ï¼‰</h3><p>åº”ç”¨å±‚ä½¿ç”¨åŸºç¡€å±‚çš„æä¾›çš„èƒ½åŠ›é€šè¿‡<code>port</code>ï¼Œåœ¨æˆ‘ä»¬çš„ä»£ç é‡Œé¢å…¶å®å°±æ˜¯æ¥å£ã€‚æ¯”å¦‚<code>GoodsRepository</code>ã€‚å¦‚æœæ“ä½œredisï¼Œé‚£<code>RedisTemplate</code>å°±æ˜¯ç«¯å£ã€‚å¯¹äºåº”ç”¨å±‚å®ƒä¸éœ€è¦å»å®ç°è¿™äº›åŸºç¡€å±‚çš„æ¥å£ï¼Œå®ƒåªéœ€è¦ä½¿ç”¨æ¥å£ã€‚</p><h3 id="_6-5-å¤–éƒ¨æ¥å£-interface" tabindex="-1"><a class="header-anchor" href="#_6-5-å¤–éƒ¨æ¥å£-interface" aria-hidden="true">#</a> 6.5 å¤–éƒ¨æ¥å£ï¼ˆ<code>Interface</code>ï¼‰</h3><p>åœ†åœˆå¤–å›´çš„å·¦åŠéƒ¨åˆ†ã€‚</p><p>å°†åº”ç”¨å±‚çš„èƒ½åŠ›æš´éœ²ç»™å¤–éƒ¨çš„å°±å«interfaceï¼ˆå’Œjavaçš„interfaceä¸æ˜¯ä¸€ä¸ªæ„æ€ï¼‰ï¼Œæˆ‘ä»¬ç†Ÿæ‚‰çš„controllerå°±æ˜¯interfaceã€‚é™¤æ­¤ä¹‹å¤–è¿˜æœ‰rabbitmqç›‘å¬æ¶ˆæ¯ä¹Ÿç®—è¿™ä¸€å±‚ã€‚</p><p>æ€»ä¹‹å¤–éƒ¨è°ƒç”¨åº”ç”¨å±‚çš„éƒ½æ˜¯è¿™ä¸€å±‚ï¼Œä¸ç®¡è°ƒç”¨æ˜¯æ¥è‡ªå‰ç«¯é¡µé¢è¿˜æ˜¯åå°ç®¡ç†å‘˜è¿˜æ˜¯æœåŠ¡å†…éƒ¨è°ƒç”¨ã€‚</p><h3 id="_6-6-queryså’Œcommands" tabindex="-1"><a class="header-anchor" href="#_6-6-queryså’Œcommands" aria-hidden="true">#</a> 6.6 <code>Querys</code>å’Œ<code>Commands</code></h3><p>å¤–éƒ¨çš„è°ƒç”¨åˆ†ä¸ºæŸ¥è¯¢ï¼ˆqueryï¼‰å’Œå¢åˆ æ”¹ï¼ˆcommandï¼‰ï¼ŒæŸ¥è¯¢æ˜¯å¯ä»¥è·³è¿‡åº”ç”¨å±‚å’Œé¢†åŸŸå±‚ï¼Œç›´æ¥è°ƒç”¨repositoryæŸ¥è¯¢ã€‚<br> è°ƒç”¨å¦‚æœæ˜¯å¢åˆ æ”¹ç±»å‹åˆ™éœ€è¦èµ°åº”ç”¨å±‚å’Œé¢†åŸŸå±‚ã€‚</p><h2 id="_7-docker-éƒ¨ç½²" tabindex="-1"><a class="header-anchor" href="#_7-docker-éƒ¨ç½²" aria-hidden="true">#</a> 7. docker éƒ¨ç½²</h2><h3 id="_7-1-åˆ¶ä½œé•œåƒ" tabindex="-1"><a class="header-anchor" href="#_7-1-åˆ¶ä½œé•œåƒ" aria-hidden="true">#</a> 7.1 åˆ¶ä½œé•œåƒ</h3><figure><img src="/blog/assets/architecture-2664fd35.svg" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>æ‰“åŒ…</p></div><p>å³ä¾§maven -&gt; microservice-parent -&gt; install</p><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>microservice-product/Dockerfile</p></div><p>ç¼–å†™dockerfileï¼Œç”Ÿæˆè‡ªå·±çš„dockeré•œåƒã€‚</p><div class="language-docker line-numbers-mode" data-ext="docker"><pre class="language-docker"><code><span class="token comment"># åŸºç¡€é•œåƒæ˜¯jdk11</span>
<span class="token instruction"><span class="token keyword">FROM</span> openjdk:11</span>
<span class="token comment"># ä½œè€…çš„ä¿¡æ¯ï¼Œå¯ä»¥ä¸å¡«</span>
<span class="token instruction"><span class="token keyword">MAINTAINER</span> http://www.jarcheng.top/blog</span>
<span class="token comment"># æ³¨æ„è¿™é‡Œï¼Œè¿™ä¸ªåœ°æ–¹è®¿é—®çš„æ˜¯buildæ—¶æŒ‡å®šçš„èµ„æºè·¯å¾„ã€‚è€Œä¸æ˜¯å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ã€‚</span>
<span class="token comment"># å°†èµ„æºè·¯å¾„å†…çš„çš„jaråŒ…å¤¹å¤åˆ¶åˆ°é•œåƒå†…å¹¶ä¸”é‡å‘½åä¸ºapp.jarã€‚</span>
<span class="token instruction"><span class="token keyword">COPY</span> microservice-product-1.0-SNAPSHOT.jar app.jar</span>
<span class="token comment"># é•œåƒå®ä¾‹åŒ–ï¼Œå³å¯åŠ¨å®¹å™¨åçš„è¿è¡Œå‘½ä»¤ï¼Œæˆ‘ä»¬è¿™è¾¹å°±æ˜¯å¯åŠ¨æœåŠ¡</span>
<span class="token instruction"><span class="token keyword">ENTRYPOINT</span> [<span class="token string">&quot;java&quot;</span>,<span class="token string">&quot;-jar&quot;</span>, <span class="token string">&quot;/app.jar&quot;</span>]</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>ç”Ÿæˆé•œåƒ</p></div><p>è¿è¡Œä¸‹é¢å‘½ä»¤æ—¶ï¼Œ<code>docker deamon</code> ä¾æ®<code>Dockerfile</code>ç”Ÿæˆé•œåƒã€‚</p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker build -f ./Dockerfile -t microservice-product:1.0  ./target
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><ol><li>æŒ‡å®šèµ„æºè·¯å¾„ï¼Œæˆ‘ä»¬è¿™è¾¹ç”¨çš„æ˜¯<code>&#39;./target&#39;</code>ã€‚</li><li>æŒ‡å®š<code>Dockerfile</code> è·¯å¾„ï¼Œdockerfileé‡Œé¢æè¿°äº†æ„å»ºé•œåƒçš„æ­¥éª¤ã€‚</li><li>æŒ‡å®šé•œåƒåå­—ï¼Œç”Ÿæˆçš„é•œåƒåå¦‚ä½•å‘½åé€šè¿‡<code>-t</code>æŒ‡å®šã€‚<code>&#39;:&#39;</code>çš„å‰æ˜¯é¢é•œåƒåç§°ï¼Œåé¢æ˜¯ç‰ˆæœ¬å·ã€‚</li></ol><h3 id="_7-2-è¿è¡Œå®¹å™¨" tabindex="-1"><a class="header-anchor" href="#_7-2-è¿è¡Œå®¹å™¨" aria-hidden="true">#</a> 7.2 è¿è¡Œå®¹å™¨</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker run -p 9000:9000 ^ 
-e spring.profiles.active=prod ^
-d ^
--name product ^
microservice-product:1.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li><code>-p</code> æŒ‡å®šæœ¬æœºç«¯å£å·åˆ°å®¹å™¨ç«¯å£çš„æ˜ å°„ã€‚</li><li><code>-e</code> æŒ‡å®šç¯å¢ƒå˜é‡ã€‚ä¿®æ”¹é…ç½®æ–‡ä»¶çš„ã€‚æˆ‘ä»¬è¿™è¾¹ä¿®æ”¹çš„æ˜¯springbootçš„<code>spring.profiles.active=prod</code>ã€‚</li><li><code>-d</code> ä»£è¡¨åå°è¿è¡Œ</li><li><code>--name</code> æŒ‡å®šå®¹å™¨åç§°</li><li>æœ€åé¢<code>microservice-product:1.0</code>ä»£è¡¨é•œåƒåç§°</li></ol><p>é•œåƒç›¸å½“äºjavaçš„ç±»ï¼Œå®¹å™¨ç›¸å½“äºjavaçš„å¯¹è±¡ã€‚ä¸€ä¸ªé•œåƒå¯ä»¥å®ä¾‹åŒ–å¤šä¸ªå®¹å™¨ã€‚</p><p>æ³¨æ„ï¼š</p><ol><li><code>-</code>æ˜¯<code>--</code>çš„ç¼©å†™ï¼Œå³<code>-p</code>=<code>--port</code>ã€‚</li><li>æœ¬å°èŠ‚çš„å®¹å™¨å¯åŠ¨ä¼šæŠ¥é”™ï¼Œå› ä¸ºspringbootæ‰¾ä¸åˆ°mysqlã€‚</li></ol><h3 id="_7-3-mysqlå®¹å™¨" tabindex="-1"><a class="header-anchor" href="#_7-3-mysqlå®¹å™¨" aria-hidden="true">#</a> 7.3 Mysqlå®¹å™¨</h3><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker run -p 3308:3306 ^
-d ^
--name mysql8 ^
-e MYSQL_ROOT_PASSWORD=qifan123. ^
-e TZ=Asia/Shanghai  ^
-e MYSQL_DATABASE=microservice ^
-v mysql-data:/var/lib/mysql ^
mysql:8.0.26 ^
mysqld --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol><li><code>-p</code>ï¼Œå› ä¸ºæˆ‘æœ¬åœ°çš„mysqlå·²ç»å ç”¨äº†3306ï¼Œæ‰€ä»¥mysqlå®¹å™¨çš„3306æ˜ å°„åˆ°æœ¬æœºçš„3308ç«¯å£ã€‚</li><li><code>-d</code>ï¼Œåå°å¯åŠ¨ã€‚</li><li><code>--name</code>ï¼ŒæŒ‡å®šå®¹å™¨åç§°</li><li><code>-e</code>ï¼Œ<code>MYSQL_ROOT_PASSWORD=qifan123</code>æŒ‡å®šrootå¯†ç ï¼Œ<br><code>MYSQL_DATABASE=microservice</code> æŒ‡å®šmysqlå¯åŠ¨åè‡ªåŠ¨åˆ›å»ºmicroserviceæ•°æ®åº“ï¼Œ<code>TZ=Asia/Shanghai</code> æŒ‡å®šmysqlçš„æ—¶åŒºã€‚</li><li><code>-v</code>ï¼ŒæŒä¹…åŒ–æ•°æ®ã€‚<code>mysql-data:/var/lib/mysql</code>ï¼Œå°†å®¹å™¨å†…çš„<code>/var/lib/mysql</code>çš„æ–‡ä»¶æ˜ å°„åˆ°docker deamonçš„<code>mysql-data</code>æ•°æ®å·å†…ã€‚ä¸ºmysqlçš„æ•°æ®éƒ½æ˜¯å­˜åœ¨<code>/var/lib/mysql</code>ä¸­ï¼Œå³ä½¿æŠŠmysqlå®¹å™¨åˆ äº†ï¼Œ<code>mysql-data</code>å†…ä¾ç„¶å­˜æœ‰æ•°æ®ã€‚è¿™æ ·å³ä½¿é‡å¯å®¹å™¨æ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚</li><li><code>mysql:8.0.26</code>ï¼Œå®¹å™¨è¦ä½¿ç”¨çš„é•œåƒã€‚</li><li><code>mysqld</code>ï¼Œå®¹å™¨å¯åŠ¨åå¯ä»¥é€‰æ‹©é¢å¤–çš„å‘½ä»¤æ“ä½œã€‚æˆ‘ä»¬è¿™è¾¹æ˜¯mysqlå¯åŠ¨åï¼Œæ‰§è¡Œ<code>mysqld --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci</code>ï¼Œå°†mysqlçš„å­—ç¬¦é›†æŒ‡å®šä¸ºutf8ã€‚</li></ol><h3 id="_7-4-å¤šå®¹å™¨è¿æ¥" tabindex="-1"><a class="header-anchor" href="#_7-4-å¤šå®¹å™¨è¿æ¥" aria-hidden="true">#</a> 7.4 å¤šå®¹å™¨è¿æ¥</h3><p>å®¹å™¨é»˜è®¤æƒ…å†µä¸‹ä¸æœ¬æœºä¸åœ¨åŒä¸€ä¸ªç½‘ç»œä¸‹ï¼Œä¸åƒæˆ‘ä»¬å¼€å‘ç¯å¢ƒé‚£æ ·å¯ä»¥é€šè¿‡localhostäº’ç›¸è®¿é—®ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿç½‘ç»œï¼Œè®©ç›¸å…³çš„å®¹å™¨åœ¨åŒä¸€ä¸ªç½‘ç»œä¸‹ï¼Œä»–ä»¬å°±å¯ä»¥å½¼æ­¤è®¿é—®äº†ã€‚</p><ol><li>åˆ›å»ºæ¡¥æ¥ç½‘ç»œ <code>docker network create microservice</code>ã€‚</li><li>mysqlè¿è¡Œå‘½ä»¤æ·»åŠ <code>--network=microservice --network-alias=microservice-mysql</code>ï¼Œç„¶åè¿è¡Œã€‚è®©mysqlå®¹å™¨åŠ å…¥<code>microservice</code>ç½‘ç»œï¼Œå¹¶ä¸”åŸŸåæ˜¯<code>microservice-mysql</code>ã€‚è¿™æ ·å•†å“æœåŠ¡å®¹å™¨å¯ä»¥é€šè¿‡<code>microservice-mysql</code>æ‰¾åˆ°mysqlå®¹å™¨çš„ipåœ°å€ã€‚</li><li>å•†å“å®¹å™¨æ·»åŠ è¿è¡Œå‘½ä»¤,<code>--network=microservice --network-alias=microservice-product</code>ï¼Œç„¶åè¿è¡Œã€‚</li></ol><h3 id="_7-5-æ€»æµç¨‹" tabindex="-1"><a class="header-anchor" href="#_7-5-æ€»æµç¨‹" aria-hidden="true">#</a> 7.5 æ€»æµç¨‹</h3><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>åˆ›å»ºç½‘ç»œ</p></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker network create microservice
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>è¿è¡Œmysqlå®¹å™¨ï¼ˆè¿œç¨‹æ‹‰å–é•œåƒï¼‰ã€‚</p></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker run -p 3308:3306 -d  --name mysql8 ^
-e MYSQL_ROOT_PASSWORD=qifan123. ^
-e TZ=Asia/Shanghai  ^
-e MYSQL_DATABASE=microservice ^
-v mysql-data:/var/lib/mysql ^
--network=microservice ^ --network-alias=microservice-mysql ^
mysql:8.0.26 ^
mysqld --character-set-server=utf8mb4 --collation-server=utf8mb4_unicode_ci
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>æ„å»ºå•†å“æœåŠ¡é•œåƒï¼ˆåœ¨microservice-productä¸‹è¿è¡Œï¼‰</p></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker build -f ./Dockerfile -t microservice-product:1.0  ./target
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>æ„å»ºè®¢å•æœåŠ¡é•œåƒï¼ˆåœ¨microservice-orderä¸‹è¿è¡Œï¼‰</p></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker build -f ./Dockerfile -t microservice-order:1.0  ./target
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>å¯åŠ¨å•†å“æœåŠ¡å®¹å™¨</p></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker run -p 9000:9000 ^
-e spring.profiles.active=prod ^
-d ^
--network=microservice ^
--network-alias=microservice-product ^
--name product ^
microservice-product:1.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>å¯åŠ¨è®¢å•æœåŠ¡å®¹å™¨</p></div><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code>docker run -p 9001:9001 ^
-e spring.profiles.active=prod ^
-d ^
--network=microservice ^
--network-alias=microservice-order ^
--name order ^
microservice-order:1.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_7-6-æ‹“å±•docker-composeä¸€æ¬¡æ€§éƒ¨ç½²" tabindex="-1"><a class="header-anchor" href="#_7-6-æ‹“å±•docker-composeä¸€æ¬¡æ€§éƒ¨ç½²" aria-hidden="true">#</a> 7.6 æ‹“å±•docker composeä¸€æ¬¡æ€§éƒ¨ç½²</h3><div class="hint-container tip"><p class="hint-container-title">æç¤º</p><p>microservice-practice/docker-compose</p></div><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">version</span><span class="token punctuation">:</span> <span class="token string">&quot;3.9&quot;</span>
<span class="token key atrule">services</span><span class="token punctuation">:</span>
  <span class="token key atrule">microservice-mysql</span><span class="token punctuation">:</span>
    <span class="token comment"># é•œåƒåç§°</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> mysql<span class="token punctuation">:</span>8.0.26
    <span class="token comment"># ç›¸å½“äº --name</span>
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> microservice<span class="token punctuation">-</span>mysql
    <span class="token comment"># ç›¸å½“äºå¤šä¸ª -e</span>
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">MYSQL_ROOT_PASSWORD</span><span class="token punctuation">:</span> qifan123.
      <span class="token key atrule">TZ</span><span class="token punctuation">:</span> Asia/Shanghai
      <span class="token key atrule">MYSQL_DATABASE</span><span class="token punctuation">:</span> microservice
    <span class="token comment"># ç›¸å½“äº -p</span>
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;3308:3306&quot;</span>
    <span class="token comment"># ç›¸å½“äº -v</span>
    <span class="token key atrule">volumes</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> microservice<span class="token punctuation">-</span>mysql<span class="token punctuation">-</span>data<span class="token punctuation">:</span>/var/lib/mysql
    <span class="token comment"># å®¹å™¨å¯åŠ¨åæ‰§è¡Œä¸‹é¢è¿™ä¸ªå‘½ä»¤</span>
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token string">&#39;mysqld&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;--character-set-server=utf8mb4&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;--collation-server=utf8mb4_unicode_ci&#39;</span> <span class="token punctuation">]</span>
  <span class="token key atrule">microservice-order</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> qifan/microservice<span class="token punctuation">-</span>order<span class="token punctuation">:</span><span class="token number">1.0</span>
    <span class="token comment"># å¦‚æœæœ¬åœ°æ‰¾ä¸åˆ°é•œåƒå°±buildä¸€ä¸‹ã€‚è¿™ä¸ªbuildæ˜¯å½“imageæ‰¾ä¸åˆ°æ—¶æ‰æ‰§è¡Œã€‚</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span>
      <span class="token comment"># æŒ‡å®šcontextåœ¨tartgetç›®å½•ä¸‹</span>
      <span class="token key atrule">context</span><span class="token punctuation">:</span> microservice<span class="token punctuation">-</span>order/target
      <span class="token comment"># å’Œ -f ä¸åŒçš„æ˜¯ï¼Œdockerfileè¿™ä¸ªå±æ€§çš„å€¼å¿…é¡»ç›¸å½“äºcontextè·¯å¾„</span>
      <span class="token comment"># contextåœ¨targetç›®å½•ï¼Œæ‰€ä»¥&#39;..&#39;æ˜¯targetçš„ä¸Šçº§ç›®å½•</span>
      <span class="token key atrule">dockerfile</span><span class="token punctuation">:</span> ../Dockerfile
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> microservice<span class="token punctuation">-</span>order
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">spring.profiles.active</span><span class="token punctuation">:</span> prod
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;9001:9001&quot;</span>
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> microservice<span class="token punctuation">-</span>mysql
  <span class="token key atrule">microservice-product</span><span class="token punctuation">:</span>
    <span class="token key atrule">image</span><span class="token punctuation">:</span> qifan/microservice<span class="token punctuation">-</span>product<span class="token punctuation">:</span><span class="token number">1.0</span>
    <span class="token comment"># å¦‚æœæœ¬åœ°æ‰¾ä¸åˆ°é•œåƒå°±buildä¸€ä¸‹ã€‚</span>
    <span class="token key atrule">build</span><span class="token punctuation">:</span>
      <span class="token key atrule">context</span><span class="token punctuation">:</span> microservice<span class="token punctuation">-</span>product/target
      <span class="token key atrule">dockerfile</span><span class="token punctuation">:</span> ../Dockerfile
    <span class="token key atrule">container_name</span><span class="token punctuation">:</span> microservice<span class="token punctuation">-</span>product
    <span class="token key atrule">environment</span><span class="token punctuation">:</span>
      <span class="token key atrule">spring.profiles.active</span><span class="token punctuation">:</span> prod
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> <span class="token string">&quot;9000:9000&quot;</span>
    <span class="token key atrule">depends_on</span><span class="token punctuation">:</span>
      <span class="token punctuation">-</span> microservice<span class="token punctuation">-</span>mysql
<span class="token key atrule">volumes</span><span class="token punctuation">:</span>
  <span class="token key atrule">microservice-mysql-data</span><span class="token punctuation">:</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ³¨æ„ï¼šå› ä¸ºåŒä¸€ä¸ª<code>services</code>ä¸‹çš„<code>service</code>é»˜è®¤éƒ½åœ¨åŒä¸€ä¸ªç½‘ç»œä¸‹ï¼Œæ‰€ä»¥ä¸éœ€è¦å†åˆ›å»ºæ¡¥æ¥ç½‘ç»œã€‚æ¯ä¸ªserviceçš„åå­—å°±æ˜¯å®ƒä»¬åœ¨è¿™ä¸ªç½‘ç»œå†…çš„åŸŸåä¾‹å¦‚<code>microservice-mysql</code>ã€‚</p></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/qifan777/qifan-blog-vuepress2/edit/master/blog/project/microservice-practice/book.md" rel="noopener noreferrer" target="_blank" aria-label="åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->åœ¨ GitHub ä¸Šç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item git-info"><div class="update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><!----></div><div class="contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: 1507906763@qq.com">èµ·å‡¡</span><!--]--><!--]--></div></div></footer><!----><div id="comment" class="giscus-wrapper input-top" style="display:block;"><div class="loading-icon-wrapper" style="display:flex;align-items:center;justify-content:center;height:96px"><svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" preserveAspectRatio="xMidYMid" viewBox="25 25 50 50"><animateTransform attributeName="transform" type="rotate" dur="2s" keyTimes="0;1" repeatCount="indefinite" values="0;360"></animateTransform><circle cx="50" cy="50" r="20" fill="none" stroke="currentColor" stroke-width="4" stroke-linecap="round"><animate attributeName="stroke-dasharray" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="1,200;90,200;1,200"></animate><animate attributeName="stroke-dashoffset" dur="1.5s" keyTimes="0;0.5;1" repeatCount="indefinite" values="0;-35px;-125px"></animate></circle></svg></div></div><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper"><div class="vp-footer">è”ç³»æ–¹å¼ï¼šljc666max</div><div class="vp-copyright">Copyright Â© 2024 èµ·å‡¡</div></footer></div><!--]--><!--]--><!----><!--]--></div>
    <script type="module" src="/blog/assets/app-fca60335.js" defer></script>
  </body>
</html>
